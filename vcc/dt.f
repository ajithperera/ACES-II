      SUBROUTINE DT(FACT,Q,DISSYQ,NUMSYQ,CHSTRG,W)
C
C   THIS ROUTINE CALCULATE THE TRANSPOSE OF Q AND SCALE IT BY FACT
C   IN ADDITION ADD IT TO Q IF ASKED
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER DISSYQ,NUMSYQ
      CHARACTER*3 CHSTRG
      DIMENSION Q(DISSYQ,NUMSYQ),W(NUMSYQ,DISSYQ)
      IF(CHSTRG.EQ.'EXT') THEN
       IF(DISSYQ.NE.NUMSYQ) STOP 'DT FATERR'
       DO 10 I=1,DISSYQ
        DO 20 J=1,I-1
         Z1=FACT*Q(I,J)
         Q(I,J)=FACT*Q(J,I)
         Q(J,I)=Z1
 20     CONTINUE
        Q(I,I)=FACT*Q(I,I)
 10    CONTINUE
      ELSE IF(CHSTRG.EQ.'ADD') THEN
       IF(DISSYQ.NE.NUMSYQ) STOP 'DT FATERR'
       DO 11 I=1,DISSYQ
        DO 21 J=1,I
         Z1=Q(I,J)+FACT*Q(J,I)
         Z2=FACT*Q(I,J)+Q(J,I)
         Q(I,J)=Z1
         Q(J,I)=Z2
 21     CONTINUE
 11    CONTINUE
      ELSE IF(CHSTRG.EQ.'NSY') THEN
       DO 12 I=1,DISSYQ
        DO 22 J=1,NUMSYQ
         W(J,I)=FACT*Q(I,J)
 22     CONTINUE
 12    CONTINUE
      ELSE
       STOP 'DT FATERR'
      ENDIF
      RETURN
      END
