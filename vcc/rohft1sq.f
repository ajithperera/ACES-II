      SUBROUTINE ROHFT1SQ(ICORE,MAXCOR,LT1OFF,IUHF,E)
c YAU - IMPLICIT INTEGER added as per a similar change for 64-bit DECs
      IMPLICIT INTEGER (A-Z)

      DOUBLE PRECISION ONE,ONEM,ZILCH,Z12,Z21,ZLS,ZLD,E4L,E,SDOT
      DIMENSION ICORE(MAXCOR)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      DATA HALF /0.5/
      DATA ONE  /1.0/   
      DATA ONEM /-1.0/
      DATA ZILCH /0.0/
      E=0.0
C
C AA AND BB CONTRIBUTIONS
C
c     DO 10 ISPIN=1,2
      DO 10 ISPIN=1,IUHF+1
       I000=1
       I010=I000+IINTFP*NT(ISPIN)
       I020=I010+IINTFP*NT(ISPIN)
       CALL GETLST(ICORE(I000),1,1,1,LT1OFF+ISPIN,90)
       CALL GETLST(ICORE(I010),1,1,1,ISPIN,90)
       IOFFT=1
       DO 20 IRREP=1,NIRREP
        NT2DSZ=IRPDPD(IRREP,ISYTYP(1,13+ISPIN))
        NT2DIS=IRPDPD(IRREP,ISYTYP(2,13+ISPIN))
        I030=I020+IINTFP*NT2DIS*NT2DSZ
        I040=I030+IINTFP*NT2DIS*NT2DSZ
        CALL IZERO(ICORE(I020),NT2DIS*NT2DSZ*IINTFP)
        CALL GTAU(ICORE(I020),ICORE(I000),ICORE(I010),ICORE(I000),
     &            ICORE(I010),NT2DSZ,NT2DIS,POP(1,ISPIN),POP(1,ISPIN),
     &            VRT(1,ISPIN),VRT(1,ISPIN),IRREP,ISPIN,ONE)
        CALL GETLST(ICORE(I030),1,NT2DIS,1,IRREP,13+ISPIN)
        E=E+SDOT(NT2DIS*NT2DSZ,ICORE(I020),1,ICORE(I030),1)
20     CONTINUE
10    CONTINUE
C
      IF(IUHF.EQ.0) E = E+E
C
C AB CONTRIBUTION
C
      I000=1
      I010=I000+IINTFP*NT(1)
      I020=I010+IINTFP*NT(2)
      I030=I020+IINTFP*NT(1)
      I040=I030+IINTFP*NT(2)
      CALL GETLST(ICORE(I000),1,1,1,1,90)
      IF(IUHF.EQ.0)THEN
       CALL GETLST(ICORE(I010),1,1,1,1,90)
      ELSE
       CALL GETLST(ICORE(I010),1,1,1,2,90)
      ENDIF
      CALL GETLST(ICORE(I020),1,1,1,LT1OFF+1,90)
      IF(IUHF.EQ.0)THEN
       CALL GETLST(ICORE(I030),1,1,1,LT1OFF+1,90)
      ELSE
       CALL GETLST(ICORE(I030),1,1,1,LT1OFF+2,90)
      ENDIF
      DO 30 IRREP=1,NIRREP
       NT2DSZ=IRPDPD(IRREP,ISYTYP(1,16))
       NT2DIS=IRPDPD(IRREP,ISYTYP(2,16))
       I050=I040+NT2DSZ*NT2DIS*IINTFP
       I060=I050+NT2DSZ*NT2DIS*IINTFP
       CALL IZERO(ICORE(I040),NT2DIS*NT2DSZ*IINTFP)
       CALL GTAU(ICORE(I040),ICORE(I000),ICORE(I020),ICORE(I010),
     &           ICORE(I030),NT2DSZ,NT2DIS,POP(1,1),POP(1,2),
     &           VRT(1,1),VRT(1,2),IRREP,3,ONE)
       CALL GETLST(ICORE(I050),1,NT2DIS,1,IRREP,16)
       E=E+SDOT(NT2DIS*NT2DSZ,ICORE(I040),1,ICORE(I050),1)
30    CONTINUE
      RETURN
      END
