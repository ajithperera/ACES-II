
      SUBROUTINE SETLOG
      COMMON /FLAGS/ IFLAGS(100)
      LOGICAL MBPT3,MBPT4,CC,TRPEND,SNGEND,GRAD,MBPTT,SING1,QCISD,
     &        NONHF,UCC,CC2
      COMMON /SWITCH/ MBPT3,MBPT4,CC,TRPEND,SNGEND,GRAD,MBPTT,SING1,
     &                QCISD,UCC,CC2
      COMMON/NHFREF/NONHF
      GRAD=.FALSE.
      MBPT3=.FALSE.
      MBPT4=.FALSE.
      CC=.FALSE.
      TRPEND=.FALSE.
      SNGEND=.FALSE.
      SING1 =.FALSE.
      MBPTT=.TRUE.
      QCISD=.FALSE.
      UCC=.FALSE.
      CC2=.FALSE.
      IF(IFLAGS(3).NE.0.OR.IFLAGS(18).NE.0.OR.
     &   IFLAGS(19).NE.0.OR.IFLAGS(43).NE.0)GRAD=.TRUE.
C
C   SET IFLAGS(3)=0 IN ORDER TO FORCE TRP NOT TO CALCULATE GRADIENTS
C   DURING THE ITERATIONS. AT CONVERGENCE, EUCC SET IT BACK
C
      IF(IFLAGS(2).EQ.9.AND.IFLAGS(3).NE.0.AND.GRAD)IFLAGS(3)=0
      IF(IFLAGS(2).EQ.2)MBPT3=.TRUE.
      IF(IFLAGS(2).EQ.3.OR.IFLAGS(2).EQ.4)MBPT4=.TRUE.
      IF(IFLAGS(2).GE.5)CC=.TRUE.
      IF(IFLAGS(2).EQ.9.AND.GRAD)TRPEND=.TRUE.
      IF(IFLAGS(2).EQ.11)TRPEND=.TRUE.
      IF(IFLAGS(2).EQ.22.OR.IFLAGS(2).EQ.21) TRPEND=.TRUE.
      IF(IFLAGS(2).EQ.9)SNGEND=.TRUE.
      IF(IFLAGS(2).EQ.4)MBPTT=.TRUE.
      IF(IFLAGS(2).EQ.21.OR.IFLAGS(2).EQ.23) QCISD=.TRUE.
      IF(IFLAGS(2).EQ.7.OR.IFLAGS(2).EQ.9)UCC=.TRUE.
      IF((IFLAGS(77)+IFLAGS(38)).NE.0)SING1=.TRUE.
      IF(IFLAGS(2).EQ.42) THEN
        IFLAGS(2) = 10
        GRAD = .TRUE.
      ENDIF
C
C It is no longer necessary to change the calclevel anymore (05/2015
C Ajith Perera)
C
      IF(IFLAGS(2).EQ.47) THEN
         CC2 = .TRUE.
CSSS         IFLAGS(2)=10
      ENDIF 
C
C HOWEVER TURN SING1 OFF IF SOMEONE REALLY WANTS TO RUN NONHF WITHOUT
C   T1!
C
      IF(SING1.AND.(IFLAGS(2).LT.9.AND.IFLAGS(2).NE.6))SING1=.FALSE.
      RETURN
      END
