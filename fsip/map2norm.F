      INTEGER FUNCTION MAP2NORM(IABSOFF,ISPIN,ITYPE,IRREP,IOFFSET)
C
C THIS FUNCTION ACCEPTS AN ABSOLUTE OFFSET FOR AN EIGENVALUE
C (BY MAGNITUDE) AND RETURNS THE IRREP AND OFFSET FOR THE
C EIGENVALUE AS WELL AS ITS ABSOLUTE OFFSET IN THE SCF STYLE
C ORDERING.
C
CEND
      IMPLICIT INTEGER (A-Z)
      CHARACTER*3 ITYPE
      CHARACTER*8 LABEL(2)
#include "maxbasfn.par"
      DOUBLE PRECISION VEC(MAXBASFN)
      DIMENSION IVEC(MAXBASFN)
      COMMON /INFO/NOCCO(2),NVRTO(2)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      DATA LABEL /'SCFEVALA','SCFEVALB'/
C
      NBAS=NOCCO(1)+NVRTO(1)
C
      CALL GETREC(20,'JOBARC',LABEL(ISPIN),NBAS*IINTFP,VEC)
C
      DO 5 I=1,NBAS
       IVEC(I)=I
 5    CONTINUE
C
      IF(ITYPE.EQ.'OCC')THEN
       CALL PIKSR2(NOCCO(ISPIN),VEC,IVEC)
       MAP2NORM=IVEC(IABSOFF)
       IOFF=0
       NTHRU=0
       NLEFT=MAP2NORM
       DO 10 IRR=1,NIRREP-1
        NSIZ=POP(IRR,ISPIN)
        IF(IOFF+NSIZ.GE.MAP2NORM)THEN
         IRREP=IRR
         IOFFSET=MAP2NORM-NTHRU
        ENDIF
        NTHRU=NTHRU+NSIZ
10     CONTINUE
C
      ELSEIF(ITYPE.EQ.'VRT')THEN
       CALL PIKSR2(NVRTO(ISPIN),VEC(NOCCO(ISPIN)+1),IVEC)
       MAP2NORM=IVEC(IABSOFF)+NOCCO(ISPIN)
       IOFF=0
       NTHRU=0
       NLEFT=MAP2NORM
       DO 20 IRR=1,NIRREP-1
        NSIZ=VRT(IRR,ISPIN)
        IF(IOFF+NSIZ.GE.MAP2NORM)THEN
         IRREP=IRR
         IOFFSET=MAP2NORM-NTHRU
        ENDIF
        NTHRU=NTHRU+NSIZ
20     CONTINUE
C
      ENDIF
C
      RETURN
      END
