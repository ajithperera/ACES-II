      SUBROUTINE EXTTAU(SCR,MAXCOR,IUHF,RLECYC,MAXORD,NEWT,IBOT,
     &                  SINGLE,RLETYP)
C
C FORMS THE TAU VECTOR USED TO EXTRAPOLATE THE AMPLITUDES.
C
CEND
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION R,ECORR,DET,TOL,ERLE,SCR,ERLET2,FACT
      LOGICAL NEWT,SINGLE,ALLDONE
      DIMENSION SCR(MAXCOR/2)
      COMMON /RMAT/ R(1000)
      COMMON /ENERGY/ ECORR(500,2),IXTRLE(500)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /FLAGS/ IFLAGS(100)
      COMMON /CONVERGE/ ALLDONE
C
C CHECK FOR CONVERGENCE NOW, BASED ON VALUE OF R(1,1).   THE SQUARE
C ROOT OF THIS VALUE IS AN UPPER BOUND TO THE LARGEST CHANGE
C
      iflags(1)=11
      tol=1.d-8
      IF(R(1).LT.TOL*TOL)THEN
       ALLDONE=.TRUE.
       RETURN
      ENDIF
C
C FORM AUGMENTED R MATRIX NOW
C
      TOL=0.0
      NROWPHYR=MAXORD
      NROWPHYS=MAXORD+1
      NCOLPHYR=NROWPHYR
      NCOLPHYS=NROWPHYS
      NROWLOGR=MIN(RLECYC-1,MAXORD)
      NROWLOGS=MIN(RLECYC-1,MAXORD)+1
      IORDER=NROWLOGR
      ISTART=NROWPHYS*NROWLOGS+1
      CALL ZERO(SCR,NROWPHYS*NCOLPHYS)
      I010=1+2*NROWPHYS*NCOLPHYS
      IOFFR=1
      IOFFS=1
      DO 6 ICOL=1,NROWLOGR
       CALL ICOPY(IINTFP*NROWLOGR,R(IOFFR),1,SCR(IOFFS),1)
       SCR(IOFFS+NROWLOGR)=-1.0
       IOFFR=IOFFR+NROWPHYR
       IOFFS=IOFFS+NROWPHYS
       SCR(NROWPHYS*NROWLOGR+ICOL)=-1.0
6     CONTINUE
      SCR(NROWPHYS*NCOLPHYS)=0.0
      DO 7 I=NROWLOGS,1,-1
       FACT=0.
       IF(I.EQ.NROWLOGS)FACT=-1.
       SCR(ISTART+I-1)=FACT
7     CONTINUE
      ISCR=NROWPHYS*(NCOLPHYS+1)
      CALL MINV(SCR,NROWLOGS,NROWPHYS,SCR(I010),DET,TOL,1,0)
      IF(IFLAGS(1).GT.10)THEN
       WRITE(6,2000)(SCR(ISTART+J),J=0,IORDER-1)
2000   FORMAT(T3,'@EXTTAU-I, Expansion coefficients: ',/,
     &        ((5F12.8)))
      ENDIF
C
C SOLUTION VECTOR NOW RESIDES IN R(ISTART..ISTART+IORDER-1).
C
C
C FORM UPDATED VECTOR
C
      IF(NEWT.OR.RLETYP.EQ.2)THEN
       WRITE(6,200)IORDER
200    FORMAT(T3,'@EXTTAU-I, Generating new solution vector from ',
     &           'previous ',I3,' iterates.')
       CALL EXTUPD(SCR(I010),MAXCOR-I010,IUHF,
     &             SCR(ISTART),IORDER,SINGLE,ERLE,RLETYP,MAXORD)
       ECORR(IBOT+RLECYC,2)=ERLE
       IXTRLE(IBOT+RLECYC)=1
       IF(RLETYP.NE.2)CALL ZERO(R,1000)
      ENDIF 
      RETURN
      END 
