
C THIS ROUTINE ADDD AN NROWFRM BY NCOLFRM BLOCK MATRIX (MATFRM)
C INTO AN NROWTAR BY NCOLTAR TARGET MATRIX (MATTAR) SUCH THAT 
C THE (1,1) ELEMENT IN MATFRM BECOMES THE IROWTAR,ICOLTAR ELEMENT 
C IN MATTAR.

      SUBROUTINE BLKADD(MATFRM,NROWFRM,NCOLFRM,MATTAR,NROWTAR,NCOLTAR,
     &                  IROWTAR,ICOLTAR)
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION MATTAR(NROWTAR*NCOLTAR),MATFRM(NROWFRM,NCOLFRM)
      DOUBLE PRECISION ONE
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      DATA ONE /1.0D0/
#ifdef _ASSERT
      if (ncolfrm.lt.0) then
         print *, '@BLKCPY: Assertion failed.'
         print *, '         ncolfrm = ',ncolfrm
         call errex
      end if
#endif /* _ASSERT */
      ISTART = IROWTAR + (ICOLTAR-1)*NROWTAR
      DO ICOL = 1, NCOLFRM
         CALL DAXPY(NROWFRM,ONE,MATFRM(1,ICOL),1,MATTAR(ISTART),1)
         ISTART = ISTART + NROWTAR
      END DO
      RETURN
      END
