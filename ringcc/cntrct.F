      SUBROUTINE CNTRCT(Q,W,T,
     &                  DISSYQ,NUMSYQ,DISSYT,NUMSYT,DISSYW,NUMSYW,
     &                  IRREP,LISTW,LISTW0,LISTT,CALMOD,C0,COEFF,ISWTCH)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      CHARACTER*3 CALMOD
      INTEGER DISSYT,DISSYW,DISSYQ
      DIMENSION W(DISSYW,NUMSYW),T(DISSYT,NUMSYT),Q(DISSYQ,NUMSYQ)
      DATA TWO /2.0/
      DATA ONEM/-1.0/
C
C PICK UP THE RELEVANT INTEGRALS.
C
      IF(ISWTCH.EQ.0)THEN
C
      
       CALL GETLST(W,1,NUMSYW,2,IRREP,LISTW)
CSSS       call output(w,1,DISSYW,1,NUMSYW,DISSYW,NUMSYW,1)
CSSS       call output(t,1,DISSYt,1,NUMSYt,DISSYt,NUMSYt,1)
       IF(CALMOD.EQ.'TxW')THEN
        CALL XGEMM('N','N',DISSYT,NUMSYW,NUMSYT,COEFF,T,DISSYT,
     &              W,DISSYW,C0,Q,DISSYQ)
       ELSEIF(CALMOD.EQ.'WxT')THEN
        CALL XGEMM('N','N',DISSYW,NUMSYT,NUMSYW,COEFF,W,DISSYW,
     &             T,DISSYT,C0,Q,DISSYQ)
       ENDIF
C
      ELSE
C
C SPIN ADAPTED CODE
C
       CALL GETLST(W,1,NUMSYW,2,IRREP,LISTW)
#ifdef _DEBUG_LVLM
       call checksum("WC   :",W,DISSYW*NUMSYW)
#endif 
       CALL GETLST(Q,1,NUMSYW,2,IRREP,LISTW0)
#ifdef _DEBUG_LVLM
       call checksum("WE   :",Q,DISSYW*NUMSYW)
#endif 
       CALL SSCAL(NUMSYW*NUMSYW,TWO,W,1)
       CALL SAXPY(NUMSYW*NUMSYW,ONEM,Q,1,W,1)

#ifdef _DEBUG_LVLM
       call checksum("T2   :",T,DISSYT*NUMSYT)
       call checksum("W1   :",W,DISSYW*NUMSYW)
#endif 
       IF(CALMOD.EQ.'TxW')THEN
        CALL XGEMM('N','N',DISSYT,NUMSYW,NUMSYT,COEFF,T,DISSYT,
     &             W,DISSYW,C0,Q,DISSYQ)
       ELSEIF(CALMOD.EQ.'WxT')THEN
        CALL XGEMM('N','N',DISSYW,NUMSYT,NUMSYW,COEFF,W,DISSYW,
     &              T,DISSYT,C0,Q,DISSYQ)
       ENDIF
C
       call checksum("W1*T2:",Q,DISSYQ*NUMSYQ)
      ENDIF
      RETURN
      END
