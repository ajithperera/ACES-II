      SUBROUTINE DRCC_INITIN(ICORE,MAXCOR,IUHF)

      IMPLICIT INTEGER (A-Z)
      LOGICAL AOBASIS
C
      DIMENSION ICORE(MAXCOR)
      COMMON/SYMINF/NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),IJUNK(18)
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(2),NF1(2),NF2(2)
C
      NSIZE=0
      DO IRREP = 1, NIRREP
         NUMSYM=IRPDPD(IRREP,ISYTYP(2,16))
         DSZSYM=IRPDPD(IRREP,ISYTYP(1,16))
         NSIZE = NSZIE + NUMSYM*DSZSYM
      ENDDO
      CALL GETALL(ICORE,NSIZE,1,16)
      CALL PUTALL(ICORE,NSIZE,1,63)
      IF (IUHF .EQ. 0)  RETURN

      DO ISPIN=1,1+IUHF
         NSIZE=0
         DO IRREP=1,NIRREP
            NUMSYM=IRPDPD(IRREP,ISYTYP(2,ISPIN))
            DSZSYM=IRPDPD(IRREP,ISYTYP(1,ISPIN))
            NSIZE=NSIZE+NUMSYM*DSZSYM
            IEND = NSIZE
            IF (IEND .GT. MAXCOR) CALL INSMEM("rcc_initin",IEND,MAXCOR)
        ENDDO
        CALL GETALL(ICORE,NSIZE,1,ISPIN)
        CALL PUTALL(ICORE,NSIZE,1,60+ISPIN)
      ENDDO 

C#ifdef _NOSKIP
      IRREPX = 1
      DO ISPIN = 1, 1+IUHF
         DO IRREPR = 1, NIRREP
            IRRRPL = DIRPRD(IRREPR,IRREPX)
         
            NROW = IRPDPD(IRREPL,ISYTYP(1,122+ISPIN))
            NCOL = IRPDPD(IRREPR,ISYTYP(2,122+ISPIN))
            NDIM = NROW * NCOL

C I(IA,JB) --> I(IA,BJ)
          
            I000 = 1
            I010 = I000 + NDIM
            I020 = I010 + NDIM
            IEND = I020
            IF (I020 .GT. MAXCOR) CALL INSMEM("rcc_initin",IEND,MAXCOR)
            CALL GETLST(ICORE(I000),1,NCOL,1,IRREPR,122+ISPIN)
            CALL SYMTRA(IRREPL,POP(1,ISPIN),VRT(1,ISPIN),NROW,
     +                  ICORE(I000),ICORE(I010))
            CALL PUTLST(ICORE(I010),1,NCOL,1,IRREPR,122+ISPIN)
         ENDDO
      ENDDO 
C#endif 
      RETURN
      END
