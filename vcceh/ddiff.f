     





 
      SUBROUTINE DDIFF(DOO,DVV,DVO,DOV,SCR,LENOO,LENVV,LENVO,ISPIN)
C
C FORMS THE DIFFERENCE BETWEEN THE DENSITY PASSED IN AND THAT
C ON LIST 160, WHICH IS TYPICALLY THE GROUND STATE DENSITY AND
C OVERWRITES THE INPUT DENSITY.
C
CEND
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION DOO(*),DVV(*),DVO(*),DOV(*),SCR(*)
      DATA ONE,ONEM,HALF,HALFM/1.0D0,-1.0D0,0.5D0,-0.5D0/
      COMMON/LISTDENS/LDENS
C
C FORM OCC-OCC DIFFERENCE DENSITY
C
      CALL GETLST (SCR,1,1,1,ISPIN,ldens)
      CALL SAXPY  (LENOO,ONEM,SCR,1,DOO,1)
C
C FORM VRT-VRT DIFFERENCE DENSITY
C
      CALL GETLST (SCR,1,1,1,2+ISPIN,ldens)
      CALL SAXPY  (LENVV,ONEM,SCR,1,DVV,1)
C
C FORM VRT-OCC DIFFERENCE DENSITY
C
      CALL GETLST (SCR,1,1,1,4+ISPIN,ldens)
      CALL SAXPY  (LENVO,ONEM,SCR,1,DVO,1)
      CALL GETLST (SCR,1,1,1,ISPIN,90)
      CALL SAXPY  (LENVO,ONEM,SCR,1,DVO,1)
C
C FORM OCC-VRT DIFFERENCE DENSITY
C
      CALL GETLST (SCR,1,1,1,ISPIN,190)
      CALL SAXPY  (LENVO,ONEM,SCR,1,DOV,1)
C
      RETURN
      END
