      SUBROUTINE FIX_AAA(S2IN,LEN,WORK,MAXCOR,ISPIN)

      IMPLICIT DOUBLE PRECISION(A-H,O-Z)

      DIMENSION WORK(MAXCOR),S2IN(LEN)

      INTEGER DISSYS,XIRREP,DIRPRD,VRT,SIRREP,POP

      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SINFO/ NS(8), SIRREP
      COMMON/SLISTS/LS1IN, LS1OUT, LS2IN(2,2), LS2OUT(2,2)

      LISTS2EX = LS2OUT(ISPIN,ISPIN+1)

C      S2IN(3) =  0.00819169666
C      S2IN(4) = -0.03714273222
C      S2IN(6) = -0.00683857248
     
C#ifdef _NOSKIP
      I000 = 1
      I010 = I000 + LEN
      CALL DCOPY(LEN,S2IN(I000),1,WORK(I000),1)

      DO XIRREP = 1, NIRREP

         IRREPA = DIRPRD(XIRREP,SIRREP)

         NROW=IRPDPD(XIRREP,ISYTYP(1,LISTS2EX))
         NCOL=VRT(IRREPA,ISPIN) * NS(SIRREP)
         NDIM= IRPDPD(XIRREP,2+ISPIN)

         I020 = I010 + NDIM*NCOL
         IOFF = I000 + POP(SIRREP,ISPIN) + NDIM*NCOL
         JOFF = I000 + POP(SIRREP,ISPIN)
         CALL ASSYM2A(XIRREP,POP(1,1),NROW,NCOL,WORK(IOFF),
     +                WORK(I020),WORK(I020))
         
         CALL SQSYM(XIRREP,POP(1,1),NDIM,NROW,NCOL,WORK(I010),
     +              WORK(IOFF))

         CALL DCOPY(NDIM*NCOL,WORK(I010),1,S2IN(JOFF),1)
#ifdef _DEBUG_LVL0
          write(6,*) 
          write(6,"(a)") "UHF:S2(ABAB) --> S2(AAAA)"
          Call output(Work(I010),1,Ndim,1,Ncol,Ndim,Ncol,1)
#endif 
      ENDDO 
C#endif 
      RETURN
      END 
