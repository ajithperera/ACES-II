      SUBROUTINE SETUP_MODF_SINGLES(ICORE,MAXCOR,ISPIN,ILIST,TYPE,
     &                              ACT,IUNIT,MODE)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      CHARACTER*8 LABEL1
      CHARACTER*1 TYPE
      CHARACTER*4 ACT, MODE
C
      DIMENSION ICORE(MAXCOR)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /INFO/ NOCCO(2),NVRTO(2)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
C
      NOCC=NOCCO(ISPIN)
      NVRT=NVRTO(ISPIN)
      NT1SIZ=IRPDPD(1,8+ISPIN)
C
      IF(ISPIN.EQ.1)THEN
         NSMSZ=NVRT*NOCC
         LABEL1='SVAOA2  '
      ELSEIF(ISPIN.EQ.2)THEN
         NSMSZ=NVRT*NOCC
         LABEL1='SVBOB2  '
      ENDIF
C
C ALLOCATE CORE FOR T/L/R VECTOR, SYMMETRY VECTORS AND INDICES.
C
      I000=1
      I010=I000+IINTFP*NT1SIZ
      I020=I010+NSMSZ
      I030=I020+NT1SIZ
      I040=I030+NT1SIZ
C
      CALL GETREC(20,'JOBARC',LABEL1,NSMSZ,ICORE(I010))
C
      CALL MODF_SINGLES(ISPIN,ILIST,NT1SIZ,NOCC,NVRT,NSMSZ,
     &                  ICORE(I000),ICORE(I010),ICORE(I020),
     &                  ICORE(I030),TYPE,ACT,IUNIT,MODE)
C
      RETURN
      END
