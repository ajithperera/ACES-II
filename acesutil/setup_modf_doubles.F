      SUBROUTINE SETUP_MODF_DOUBLES(ICORE,MAXCOR,ISPIN,ILIST,TYPE,
     &                              ACT,IUNIT)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      CHARACTER*8 LABEL1,LABEL2
      CHARACTER*1 TYPE
      CHARACTER*4 ACT
C
      DIMENSION ICORE(MAXCOR)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /INFO/ NOCCO(2),NVRTO(2)
      NNM1O2(I)=(I*(I-1))/2
C
      NOCCA=NOCCO(1)
      NOCCB=NOCCO(2)
      NVRTA=NVRTO(1)
      NVRTB=NVRTO(2)
C
      IF(ISPIN.EQ.1)THEN
        NT2SIZ=ISYMSZ(ISPIN,ISPIN+2)
        NSMSZ1=NNM1O2(NVRTO(ISPIN))
        NSMSZ2=NNM1O2(NOCCO(ISPIN))
        LABEL1='SVAVA0  '
        LABEL2='SOAOA0  '
      ELSEIF(ISPIN.EQ.2)THEN
        NT2SIZ=ISYMSZ(ISPIN,ISPIN+2)
        NSMSZ1=NNM1O2(NVRTO(ISPIN))
        NSMSZ2=NNM1O2(NOCCO(ISPIN))
        LABEL1='SVBVB0  '
        LABEL2='SOBOB0  '
      ELSEIF(ISPIN.EQ.3)THEN
        NT2SIZ=ISYMSZ(13,14)
        NSMSZ1=NVRTO(1)*NVRTO(2)
        NSMSZ2=NOCCO(1)*NOCCO(2)
        LABEL1='SVAVB2  '
        LABEL2='SOAOB2  '
      ENDIF
C
C ALLOCATE CORE FOR T/L/R VECTOR, SYMMETRY VECTORS AND INDICES.
C
      I000=1
      I010=I000+IINTFP*NT2SIZ
      I020=I010+NSMSZ1
      I030=I020+NSMSZ2
      I040=I030+NT2SIZ
      I050=I040+NT2SIZ
      I060=I050+NT2SIZ
      I070=I060+NT2SIZ
C
      CALL GETREC(20,'JOBARC',LABEL1,NSMSZ1,ICORE(I010))
      CALL GETREC(20,'JOBARC',LABEL2,NSMSZ2,ICORE(I020))
C
      CALL MODF_DOUBLES(ISPIN,ILIST,NT2SIZ,NOCCA,NOCCB,NVRTA,
     &                  NVRTB,NSMSZ1,NSMSZ2,ICORE(I000),ICORE(I010),
     &                  ICORE(I020),ICORE(I030),ICORE(I040),
     &                  ICORE(I050),ICORE(I060),TYPE,ACT,IUNIT)
C
      RETURN
      END
