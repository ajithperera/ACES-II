C
C THIS ROUTINE CALCULATES THE ADDRESSES OF THE VARIOUS LISTS
C  IN THE MOINTS FILE.  
C
C THIS ROUTINE IS CALLED IN INTPRC TO INITIALIZE THE MOINTS FILE
C AND TO CREATE ALL THE INTEGRAL AND AMPLITUDE LISTS ON MOINTS
C (AT LEAST THE STANDARD LISTS)
C
#include "flags.h" /* for h_IFLAGS_* and h_IFLAGS2_* */
C 
      SUBROUTINE CLMOIO(ICORE,MAXCOR,NOCCO,NVRTO,IUHF)
      IMPLICIT INTEGER(A-H,O-Z)
      LOGICAL DOALL,ABIJ,NOABCD,NO_REDUNDANT
      COMMON /FLAGS/ IFLAGS(100)
      COMMON /FLAGS2/ IFLAGS2(500)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /FILES/ LUOUT,MOINTS
      COMMON /SYMINF/ NSTART,NIRREP,IRREPY(255,2),DIRPRD(8,8)
      COMMON /CONTROL/ IPRNT,IXXX,IXXX2
      COMMON /DOINTS/ DOALL,ABIJ,NOABCD
      COMMON /SHIFT/  ISHIFT,NDRGEO
      DIMENSION NOCCO(2),NVRTO(2),ICORE(MAXCOR)
      IX1(I)=(I*(I-1))/2
      IX2(I)=(I*(I+1))/2
      NOCCA=NOCCO(1)
      NOCCB=NOCCO(2)
      NVRTA=NVRTO(1)
      NVRTB=NVRTO(2)
      NINT=0
      NAMP=0
      NO_REDUNDANT = iflags2(h_IFLAGS2_single_store).ne.0 
c      IMODE=1
c      IMODE3=1
      call aces_io_reset
      IMODE=0
      IMODE3=0
      Write(6,*) "The ISHIFT=", ishift
      NFULL=NOCCA*NOCCB*NVRTA*NVRTB
C***********************************************************************
C PHHH INTEGRALS.
C
      IF(.NOT.ABIJ)THEN
c      CALL INIPCK(1,3,16,7,IMODE,0,1)
       CALL INIPCK(1,3,16,7+ISHIFT,IMODE,0,1)
       IF(IUHF.NE.0)THEN
c       CALL INIPCK(1,4,17,8,IMODE,0,1)
        CALL INIPCK(1,4,17,8+ISHIFT,IMODE,0,1)
c       CALL INIPCK(1,14,11,9,IMODE,0,1)
        CALL INIPCK(1,14,11,9+ISHIFT,IMODE,0,1)
       ENDIF
c      CALL INIPCK(1,14,18,10,IMODE,0,1)
       CALL INIPCK(1,14,18,10+ISHIFT,IMODE,0,1)
C***********************************************************************
C PHPH INTEGRALS.
C
c      CALL INIPCK(1,9,9,23,IMODE,0,1)
       CALL INIPCK(1,9,9,23+ISHIFT,IMODE,0,1)
c      IF(IUHF.NE.0)CALL INIPCK(1,10,10,24,IMODE,0,1)
       IF(IUHF.NE.0)CALL INIPCK(1,10,10,24+ISHIFT,IMODE,0,1)
c      CALL INIPCK(1,11,11,25,IMODE,0,1)
       CALL INIPCK(1,11,11,25+ISHIFT,IMODE,0,1)
c      IF(IUHF.NE.0)CALL INIPCK(1,12,12,26,IMODE,0,1)
       IF(IUHF.NE.0)CALL INIPCK(1,12,12,26+ISHIFT,IMODE,0,1)
C***********************************************************************
C PPPH INTEGRALS.
C
       IF(IUHF.NE.0)THEN
c       CALL INIPCK(1,1,9,27,IMODE,0,1)
        CALL INIPCK(1,1,9,27+ISHIFT,IMODE,0,1)
c       CALL INIPCK(1,2,10,28,IMODE,0,1)
        CALL INIPCK(1,2,10,28+ISHIFT,IMODE,0,1)
c       CALL INIPCK(1,13,18,29,IMODE,0,1)
        CALL INIPCK(1,13,18,29+ISHIFT,IMODE,0,1)
       ENDIF
c      CALL INIPCK(1,13,11,30,IMODE,0,1)
       CALL INIPCK(1,13,11,30+ISHIFT,IMODE,0,1)
      ENDIF
C**********************************************************************
C PPPP INTEGRALS.  AA TYPE ARE STORED SYMMETRY PACKED SO WE NEED
C  TO GET THE APPROPRIATE SYMMETRY INFORMATION FIRST.  THESE AND
C  THE HHHH INTEGRALS ARE DONE ONLY IF THE CALCLEVEL IS HIGHER THAN
C  MBPT(2).
C
      IF(.NOT.NOABCD)THEN
c       IF(IUHF.NE.0)THEN
c        CALL INIPCK(1,1,1,231,IMODE3,0,1)
c        CALL INIPCK(1,2,2,232,IMODE3,0,1)
c        CALL INIPCK(1,13,13,233,IMODE3,0,1)
c       ELSE
C
C  CURRENTLY WE ARE USING FOR GRADIENT RUNS A DIFFERENT THAN IN
C  ENERGY CALCULATIONS
C
c        IF(IFLAGS(3).NE.0.OR.IFLAGS(18).NE.0.OR.
c     &     IFLAGS(19).NE.0) THEN
c         CALL INIPCK(1,13,13,233,IMODE3,0,1)
c        ELSE 
c         CALL INIPCK(1,5,13,233,IMODE3,0,1)
c        ENDIF
c       ENDIF
      ENDIF
C**********************************************************************
C HHHH INTEGRALS.  AA TYPE ARE STORED SYMMETRY PACKED SO WE NEED
C  TO GET THE APPROPRIATE SYMMETRY INFORMATION FIRST.
C
      IF(.NOT.ABIJ)THEN
       IF(IUHF.NE.0)THEN
c       CALL INIPCK(1,3,3,11,IMODE,0,1)
        CALL INIPCK(1,3,3,11+ISHIFT,IMODE,0,1)
c       CALL INIPCK(1,4,4,12,IMODE,0,1)
        CALL INIPCK(1,4,4,12+ISHIFT,IMODE,0,1)
       ENDIF
c      CALL INIPCK(1,14,14,13,IMODE,0,1)
       CALL INIPCK(1,14,14,13+ISHIFT,IMODE,0,1)
      ENDIF
C***********************************************************************
C DENOMINATOR ARRAYS
C
      CALL INIPCK(1,1,3,48,IMODE,0,1)
      CALL INIPCK(1,13,14,50,IMODE,0,1)
      IF(IUHF.NE.0)CALL INIPCK(1,2,4,49,IMODE,0,1)
      IF(IFLAGS(21).NE.3)THEN
       CALL INIPCK(1,1,3,64,IMODE,0,1)
       CALL INIPCK(1,13,14,66,IMODE,0,1)
       IF(IUHF.NE.0)CALL INIPCK(1,2,4,65,IMODE,0,1)
      ENDIF
C***********************************************************************
C PPHH INTEGRALS.  THESE SIT NEXT TO T AMPLITUDES ON DISK.
C
c     CALL INIPCK(1,1,3,14,IMODE,0,1)
      CALL INIPCK(1,1,3,14+ISHIFT,IMODE,0,1)
      IF(IUHF.NE.0)THEN
c      CALL INIPCK(1,2,4,15,IMODE,0,1)
       CALL INIPCK(1,2,4,15+ISHIFT,IMODE,0,1)
c      CALL INIPCK(1,10,9,17,IMODE,0,1)
C
       CALL INIPCK(1,10,9,17+ISHIFT,IMODE,0,1)
C
c      CALL INIPCK(1,10,10,20,IMODE,0,1)
C
       CALL INIPCK(1,10,10,20+ISHIFT,IMODE,0,1)
C
c      CALL INIPCK(1,10,10,6,IMODE,0,1)
       CALL INIPCK(1,10,10,6+ISHIFT,IMODE,0,1)
c      CALL INIPCK(1,12,11,22,IMODE,0,1)
C
       CALL INIPCK(1,12,11,22+ISHIFT,IMODE,0,1)
C
      ENDIF
c     CALL INIPCK(1,13,14,16,IMODE,0,1)
      CALL INIPCK(1,13,14,16+ISHIFT,IMODE,0,1)
C
c     CALL INIPCK(1,9,10,18,IMODE,0,1)
C
      CALL INIPCK(1,9,10,18+ISHIFT,IMODE,0,1)
C
c     CALL INIPCK(1,9,9,19,IMODE,0,1)
C
      CALL INIPCK(1,9,9,19+ISHIFT,IMODE,0,1)
C
c     CALL INIPCK(1,9,9,5,IMODE,0,1)
      CALL INIPCK(1,9,9,5+ISHIFT,IMODE,0,1)
c     CALL INIPCK(1,11,12,21,IMODE,0,1)
C
      CALL INIPCK(1,11,12,21+ISHIFT,IMODE,0,1)
C
C
C***********************************************************************
C T2 AMPLITUDES (START ON PHYSICAL RECORD BOUNDARY)
C
      CALL INIPCK(1,13,14,46,IMODE,-1,1)
      CALL INIPCK(1,1,3,44,IMODE,0,1)
      IF(IUHF.NE.0)CALL INIPCK(1,2,4,45,IMODE,0,1)
C
C ONLY NEED THE REST FOR POST-MBPT(2) STUFF.
C
C SG 4/24/96 Remodified by Ajith 03/20/97
C      IF(IFLAGS(2).GT.1.OR.IFLAGS(22).NE.0)THEN
      IF (IFLAGS(2).GT.1.OR.IFLAGS(22).NE.0.OR.IFLAGS2(117).GT.0) THEN
       CALL INIPCK(1,9,9,34,IMODE,0,1)
       CALL INIPCK(1,9,10,37,IMODE,0,1)
       CALL INIPCK(1,11,12,39,IMODE,0,1)
       IF(IUHF.NE.0)THEN

        CALL INIPCK(1,10,9,36,IMODE,0,1)
        CALL INIPCK(1,12,11,38,IMODE,0,1)
        CALL INIPCK(1,10,10,35,IMODE,0,1)
       ENDIF
      ENDIF
      IF(IFLAGS(1).GT.100)CALL aces_io_summary
      RETURN
      END
