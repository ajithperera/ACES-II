      SUBROUTINE STABLE(ICORE,MAXCOR,IUHF)
C
C STABILITY CHECK FOR RHF AND UHF WAVEFUNCTIONS
C
      IMPLICIT INTEGER (A-Z)
      DIMENSION ICORE(MAXCOR)
C
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /FLAGS/ IFLAGS(100)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
C
      IF(IUHF.EQ.0)THEN
       NSIZ=IRPDPD(1,ISYTYP(1,25))
       I000=1
       I010=I000+2*IINTFP*NSIZ
       MXCOR=MAXCOR-I010+1
       CALL RHFSTAB(ICORE(I010),MXCOR,ICORE(I000),NSIZ,IUHF)
C
      ELSEIF(IUHF.EQ.1)THEN
       NSIZ=IRPDPD(1,ISYTYP(1,19))+IRPDPD(1,ISYTYP(1,20))
       I000=1
       I010=I000+2*IINTFP*NSIZ
       MXCOR=MAXCOR-I010+1
       CALL UHFSTAB(ICORE(I010),MXCOR,ICORE(I000),NSIZ,IUHF)
C
      ELSEIF(IUHF.EQ.2)THEN
       WRITE(6,100)
100    FORMAT(T3,'@STABLE-F, Stability analysis unavailable for ROHF.')
       CALL ERREX
      ENDIF
C
      RETURN
      END
