
      SUBROUTINE BINVEC(V,INBIN,TOL,BINSIZ,LEN,NBIN,SMLTOL)
C
C THIS ROUTINE SORTS VECTOR ELEMENTS INTO BINS.  THE BIN WIDTH
C  IS INPUT IN NBIN AND THE NUMBER OF BINS IN NBIN.  TOL IS A
C  SCRATCH VECTOR.   NOTE THAT THIS ROUTINE DESTROYS THE SIGN
C  INFORMATION IN THE VECTOR.
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION V(LEN),INBIN(NBIN),TOL(NBIN)
      CALL ZERO(INBIN,NBIN)
      IEXACT=0
      NTOT=0
      DO 5 I=1,LEN
       V(I)=DABS(V(I))
5     CONTINUE
C
C COMPUTE LOWEST TOLERABLE VALUES FOR EACH BIN.
C
      DO 10 I=1,NBIN
       TOL(I)=(I-1)*BINSIZ
 10   CONTINUE
C
C BIN VALUES ONE-BY-ONE.
C
      DO 20 I=1,LEN
       IF(V(I).LT.SMLTOL)THEN
        IEXACT=IEXACT+1
        GOTO 20
       ENDIF
       DO 30 J=1,NBIN
        IF(V(I).GT.TOL(J))THEN
         IHIT=J
        ELSE
         GOTO 1
        ENDIF
30     CONTINUE
1      INBIN(IHIT)=INBIN(IHIT)+1
20    CONTINUE
      WRITE(6,100)SMLTOL
100   FORMAT(T20,'Distribution of amplitude vector',/,
     & T20,'(Values below ',E8.5,' ignored)',/,T5,'Bottom',
     &T21,'Top',T59,'Cumulative',/,T6,'Value',T20,'Value',T34,
     &'Number',T46,'Cumulative',T59,'Percentage')
      DO 50 I=1,NBIN
       NTOT=NTOT+INBIN(I)
       PERT=100.D0*(FLOAT(NTOT)/FLOAT(LEN-IEXACT))
       IF(I.LT.NBIN)THEN
        WRITE(6,200)TOL(I),TOL(I+1),INBIN(I),NTOT,PERT
       ELSE
        WRITE(6,201)TOL(I),INBIN(I),NTOT,PERT
       ENDIF
50    CONTINUE
200   FORMAT(T5,F6.3,T19,F6.3,T30,I9,T46,I9,T61,F7.3)
201   FORMAT(T5,F6.3,T19,'and above',T30,I9,T46,I9,T61,F7.3)
      RETURN
      END
