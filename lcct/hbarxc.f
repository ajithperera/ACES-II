      SUBROUTINE HBARXC(ICORE,MAXCOR,IUHF,ISIDE,IRREPX)
C
C THIS ROUTINE DRIVES THE CALCULATION OF THE MATRIX-VECTOR
C PRODUCT BETWEEN A SINGLES AND DOUBLES HAMILTONIAN MATRIX
C AND A VECTOR.
C
CEND
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION TIN, TOUT, TIMDUM, TDAVID, TMULT,
     &                 TIMEIN, TIMENOW, TIMETOT, TIMENEW
      DIMENSION ICORE(MAXCOR)
      DIMENSION LISTIJKL(2),LISTIJKA(2),LISTAIBJ(2),LISTABCI(2)
      DIMENSION LISTABCD(2)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/EXTRAP/MAXEXP,NREDUCE,NTOL,NSIZEC
      COMMON/TIMSUB/TDAVID, TMULT, TQUAD
      COMMON /TIMEINFO/ TIMEIN, TIMENOW, TIMETOT, TIMENEW
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),ID(18)
C
      DATA LISTABCD/231,231/
      DATA LISTABCI/127, 27/
      DATA LISTIJKA/107,  7/
      DATA LISTIJKL/ 51, 51/
      DATA LISTAIBJ/ 54, 54/
      DATA LISTT1,LISTT2,LISTT2IN,LISTT2RS  /490,444,461,440/
      DATA LSTT2RNG /434/
C
      CALL TIMER(1)
C
C INITIALIZE T2 INCREMENT LIST
C
      DO 10 ISPIN=3,3-2*IUHF,-1
        CALL ZEROLIST(ICORE,MAXCOR,LISTT2IN-1+ISPIN)
 10   CONTINUE
C
C CALCULATE H x C1 -> C1
C
        CALL DT1INT1(ICORE,MAXCOR,IUHF,IRREPX,IUHF.EQ.0,LISTAIBJ(1),
     &     LISTT1,ISIDE)
        CALL DFT1INT1(ICORE,MAXCOR,IUHF,IRREPX,LISTT1,ISIDE)
C
C CALCULATE H x C2 -> C1
C
          CALL DT2INT1A(ICORE,MAXCOR,IUHF,IRREPX,LISTABCI(3-ISIDE),
     &       LISTT2,LISTT1)
          CALL DT2INT1B(ICORE,MAXCOR,IUHF,IRREPX,LISTIJKA(3-ISIDE),
     &       LISTT2,LISTT1)
          CALL RESORT(ICORE,MAXCOR,IUHF,IRREPX,LISTT2,LSTT2RNG)
          IF (ISIDE.EQ.1) THEN
            CALL DFT2INT1(ICORE,MAXCOR,IUHF,1,IRREPX)
          ENDIF
C
C CALCULATE H x C1 -> C2
C
          CALL DT1INT2A(ICORE,MAXCOR,IUHF,IRREPX,LISTIJKA(ISIDE),
     &       LISTT2IN,LISTT1)
          CALL DT1INT2B(ICORE,MAXCOR,IUHF,IRREPX,LISTABCI(ISIDE),
     &       LISTT2IN,LISTT1)

C
C CALCULATE H x C2 -> C2
C
          CALL DT2INT2 (ICORE,MAXCOR,IUHF,IRREPX,ISIDE,LISTIJKL,
     &       LISTABCD,LISTAIBJ,LISTT2,LISTT2IN,LISTT2RS,LSTT2RNG)
C
C
C
      CALL TIMER(1)
      TMULT = TMULT + TIMENEW
C
      RETURN
      END
