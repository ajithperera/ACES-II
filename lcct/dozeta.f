      SUBROUTINE DOZETA(ICORE,MAXCOR,IUHF,LENTOT,LISTZ1,LISTZ1OFF,
     &   LISTZ2)
C
C DRIVER FOR THE SOLUTION OF THE ZETA EQUATIONS THAT OCCUR IN
C EOM-CC GRADIENT THEORY.  TWO ALGORITHMS ARE AVAILABLE -- THE
C ORTHOGONAL SUBSPACE APPROACH OF POPLE AND THE DIIS METHOD DESCRIBED
C BY PULAY.  THE ALGORITHM IS SPECIFIED BY THE VALUE OF THE KEYWORD
C ZETA_TYPE, WHICH CAN BE EITHER "POPLE" OR "DIIS", WITH THE LATTER
C BEING THE DEFAULT.
C
CEND
      IMPLICIT INTEGER(A-Z)
      DIMENSION ICORE(MAXCOR)
      COMMON/FLAGS/IFLAGS(100)
      COMMON/FLAGS2/IFLAGS2(500)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
C
      KMAX=IFLAGS(97)
      I000=1
      I010=I000+KMAX*KMAX*IINTFP
C
      IF(IFLAGS2(1).EQ.0)THEN
       I020=I010+KMAX*KMAX*IINTFP
       MXCOR=MAXCOR-I020+1
       MXCOR = MXCOR/IINTFP
       CALL CALCZETA(ICORE(I020),MXCOR,IUHF,ICORE(I000),ICORE(I010),
     &               KMAX,LENTOT,LISTZ1,LISTZ1OFF,LISTZ2)
      ELSE
       MXCOR = MAXCOR - I010 + 1
       MXCOR = MXCOR/IINTFP
       CALL CLCZETA2(ICORE(I010),MXCOR,IUHF,ICORE(I000),
     &               KMAX,LENTOT,IFLAGS(88),IFLAGS2(2),LISTZ1,LISTZ1OFF,
     &               LISTZ2)
      ENDIF
C
      RETURN
      END
