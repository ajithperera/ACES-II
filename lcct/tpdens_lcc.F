      SUBROUTINE TPDENS_LCC(ICORE,MAXCOR,IUHF,LISTR1,LISTL1,LISTR1OFF,
     &                      LISTL1OFF,LISTR2,LISTL2,LISTR2RS,LISTL2RS)
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
#include "machsp.com"
      LOGICAL GABCD
      DIMENSION ICORE(MAXCOR)
C
C DRIVER ROUTINE FOR THE CALCULATION OF THE
C TWO-PARTICLE DENSITY MATRIX IN EOM-CCSD
C GRADIENT CALCULATIONS
C
CEND
C
C CODED SEPTEMBER/93 JG
C
      COMMON/ABCD/GABCD
      COMMON/SYMPOP/IRPDPD(8,22)
C
      DATA ONE,ONEM,HALF,ZILCH /1.0D0,-1.0D0,0.5D0,0.0d0/
C
C INITIALIZE LISTS FOR TWO-PARTICLE-DENSITY ON GAMLAM

C
C G(IJ,KL)
      CALL TPDIJKL(ICORE,MAXCOR,IUHF,LISTL2,LISTR1,LISTR1OFF,LISTR2)
C
C G(AB,CD)
      IF(.NOT.GABCD)
     &   CALL TPDABCD(ICORE,MAXCOR,IUHF,LISTL2,LISTR1,LISTR1OFF,LISTR2)
C
C G(AI,BC) AND G(AB,CI)
      CALL TPDAIBC(ICORE,MAXCOR,IUHF,HALF,LISTL2,LISTR1,LISTR1OFF)
      CALL TPDABCI(ICORE,MAXCOR,IUHF,LISTL1,LISTL1OFF,LISTL2,LISTL2RS,
     &   LISTR1,LISTR1OFF,LISTR2,LISTR2RS)
C
C G(IA,JK) AND G(IJ,KA)
      CALL TPDIAJK(ICORE,MAXCOR,IUHF,HALF,LISTL2,LISTR1,LISTR1OFF)
      CALL TPDIJKA(ICORE,MAXCOR,IUHF,LISTL1,LISTL1OFF,LISTL2,LISTL2RS,
     &   LISTR1,LISTR1OFF,LISTR2,LISTR2RS)
C
C G(AI,BJ)
      CALL TPDAIBJ(ICORE,MAXCOR,IUHF,LISTL1,LISTL1OFF,LISTL2RS,LISTR1,
     &   LISTR1OFF,LISTR2RS)
C
C G(IJ,AB)
      CALL TPDIJAB(ICORE,MAXCOR,IUHF,LISTL1,LISTL1OFF,LISTL2,LISTL2RS,
     &   LISTR1,LISTR1OFF,LISTR2,LISTR2RS,ZILCH)
C
C CALL ROUTINES TO CALCULATE G(ABCD) CONTRIBUTIONS TO
C I(AB) AND I(AI) IF G(ABCD) IS NOT STORED.
C
      IF(GABCD)THEN
         WRITE(6,1000)
 1000    FORMAT(T3,'@TPDENS-I, Gamma(abcd) contributions to ',
     &      'intermediates calculated directly.')
         CALL IABCONT(ICORE,MAXCOR,IUHF,LISTL2,LISTR1,LISTR1OFF,LISTR2)
         CALL IAICONT(ICORE,MAXCOR,IUHF,LISTL2,LISTR1,LISTR1OFF,LISTR2)
      ENDIF

      RETURN
      END
