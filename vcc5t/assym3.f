      SUBROUTINE ASSYM3(IRREP,POPVRT,DSZA,DSZB,NDIS,A,B,IOFF,ISPIN)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER DSZA,DSZB,POPVRT,DIRPRD
      DIMENSION A(DSZA,NDIS),B(DSZB,NDIS)
      DIMENSION POPVRT(8),IOFF(8,8,10)
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     1                DIRPRD(8,8)
C
      INDEX(I) = I*(I-1)/2
C
      CALL ZERO(A,DSZA*NDIS)
      DO   60 IDIS=1,NDIS
C
      DO   50 IRPJ=1,NIRREP
C
      IRPI = DIRPRD(IRPJ,IRREP)
C
      IF(IRPI.GT.IRPJ) GOTO 50
C
      IF(IRPI.EQ.IRPJ)THEN
C
      DO   20 J=2,POPVRT(IRPJ)
      DO   10 I=1,J-1
C
      ILTJ = IOFF(IRPJ,IRREP,ISPIN) + INDEX(J-1) + I
      IJ   = IOFF(IRPJ,IRREP,    5) + (J-1)*POPVRT(IRPI) + I
      JI   = IOFF(IRPI,IRREP,    5) + (I-1)*POPVRT(IRPJ) + J
C
      A(ILTJ,IDIS) = B(IJ,IDIS) - B(JI,IDIS)
   10 CONTINUE
   20 CONTINUE
C
      ELSE
C
      DO   40 J=1,POPVRT(IRPJ)
      DO   30 I=1,POPVRT(IRPI)
C
      ILTJ = IOFF(IRPJ,IRREP,ISPIN) + (J-1)*POPVRT(IRPI) + I
      IJ   = IOFF(IRPJ,IRREP,    5) + (J-1)*POPVRT(IRPI) + I
      JI   = IOFF(IRPI,IRREP,    5) + (I-1)*POPVRT(IRPJ) + J
C
      A(ILTJ,IDIS) = B(IJ,IDIS) - B(JI,IDIS)
   30 CONTINUE
   40 CONTINUE
      ENDIF
C
   50 CONTINUE
   60 CONTINUE
C
      RETURN
      END
