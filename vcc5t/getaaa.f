      SUBROUTINE GETAAA(T2AAA,IRPJ,J,ISPIN)
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION T2AAA(1)
      DIMENSION IADT2(8),LENT2(8)
C
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     1                DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYM/    POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF2AA,
     1                NF1BB,NF2BB
      COMMON /INFO/   NOCCO(2),NVRTO(2)
      COMMON /FLAGS/  IFLAGS(100)
      EQUIVALENCE(ICLLVL,IFLAGS( 2))
      EQUIVALENCE(IDRLVL,IFLAGS( 3))
      EQUIVALENCE(IREFNC,IFLAGS(11))
C
      COMMON /T3OFF/  IOFFVV(8,8,10),IOFFOO(8,8,10),IOFFVO(8,8,4)
C
      INDEX(I) = I*(I-1)/2
C
C     SET ADDRESSES FOR T2.
C
      DO  130 IRPL=1,NIRREP
      IRPJL = DIRPRD(IRPL,IRPJ)
      IRPAB = IRPJL
      LENT2(IRPL) = IRPDPD(IRPAB,ISPIN) * POP(IRPL,ISPIN)
      IF(IRPL.EQ.1)THEN
      IADT2(IRPL) = 1
      ELSE
      IADT2(IRPL) = IADT2(IRPL-1) + LENT2(IRPL-1)
      ENDIF
  130 CONTINUE
C
C     READ T2(A<B,L).
C
      DO  170 IRPL=1,NIRREP
      IF(POP(IRPL,ISPIN).EQ.0) GOTO 170
      IRPJL = DIRPRD(IRPJ,IRPL)
C
      IF(IRPJ.LT.IRPL)THEN
      DO  140    L=1,POP(IRPL,ISPIN)
      JL = IOFFOO(IRPL,IRPJL,ISPIN) + (L-1)*POP(IRPJ,ISPIN) + J
      CALL GETLST(T2AAA(IADT2(IRPL) + (L-1)*IRPDPD(IRPJL,ISPIN)),
     1            JL,1,1,IRPJL,43+ISPIN)
  140 CONTINUE
      ENDIF
C
      IF(IRPJ.GT.IRPL)THEN
      JL = IOFFOO(IRPJ,IRPJL,ISPIN) + (J-1)*POP(IRPL,ISPIN) + 1
      CALL GETLST(T2AAA(IADT2(IRPL)),
     1            JL,POP(IRPL,ISPIN),1,IRPJL,43+ISPIN)
      CALL VMINUS(T2AAA(IADT2(IRPL)),LENT2(IRPL))
      ENDIF
C
      IF(IRPJ.EQ.IRPL)THEN
      DO  160    L=1,POP(IRPL,ISPIN)
C
      IF(J.LT.L)THEN
      JL = IOFFOO(IRPL,IRPJL,ISPIN) + INDEX(L-1) + J
      CALL GETLST(T2AAA(IADT2(IRPL) + (L-1)*IRPDPD(IRPJL,ISPIN)),
     1            JL,1,1,IRPJL,43+ISPIN)
      ENDIF
C
      IF(J.GT.L)THEN
      JL = IOFFOO(IRPJ,IRPJL,ISPIN) + INDEX(J-1) + L
      CALL GETLST(T2AAA(IADT2(IRPL) + (L-1)*IRPDPD(IRPJL,ISPIN)),
     1            JL,1,1,IRPJL,43+ISPIN)
      CALL VMINUS(T2AAA(IADT2(IRPL) + (L-1)*IRPDPD(IRPJL,ISPIN)),
     1            IRPDPD(IRPJL,ISPIN))
      ENDIF
C
      IF(J.EQ.L)THEN
      CALL ZERO(T2AAA(IADT2(IRPL) + (L-1)*IRPDPD(IRPJL,ISPIN)),
     1          IRPDPD(IRPJL,ISPIN))
      ENDIF
  160 CONTINUE
C
      ENDIF
  170 CONTINUE
      RETURN
      END
