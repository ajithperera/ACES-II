      SUBROUTINE DVCC(ICORE,MAXCOR,IUHF,ANTI)
C
C VECTORIZED COUPLED-PERTURBED CC/MBPT DRIVER ROUTINE 
C
C THIS ROUTINE SOLVES THE EQUATIONS FOR THE 
C DERIVATIVES OF THE T AMPLITUDES. 
C
C FOR A THEORETICAL DISCUSSION:
C
C   E.A. SALTER, PH.D. THESIS, U.F. 1988
C   E.A. SALTER AND R.J. BARTLETT, J. CHEM. PHYS. 90 (1989) 1767
C   J. GAUSS AND J.F. STANTON, UNPUBLISHED
C
C THIS PROGRAM IS EXTENSIVELY VETCORIZED AND USES EXPLICITLY
C SYMMETRY BASED ON A DIRECT PRODUCT DECOMPOSITION GENERALIZED
C FOR PERTURBATION DEPENDENT QUANTITIES.
C
CEND
C
C THIS PROGRAM HAS BEEN DEVELOPED AT THE QUANTUM THEORY PROJECT
C IN 1991 BY J.GAUSS AND J.F. STANTON
C
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER POP,VRT,DIRPRD
      LOGICAL MBPT2,MBPT3,M4DQ,M4SDQ,M4SDTQ,CCD,QCISD,CCSD
      LOGICAL QRHF,ROHF,SEMI,FIELD,GEOM,ANTI
C
      DIMENSION ICORE(MAXCOR)
C
      COMMON/INFO/NOCCO(2),NVRTO(2)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/FLAGS/IFLAGS(100)
      COMMON/METH/MBPT2,MBPT3,M4DQ,M4SDQ,M4SDTQ,CCD,QCISD,CCSD
      COMMON/DTRAN/FIELD,GEOM,ROHF,QRHF,SEMI
      COMMON/SYM/POP(8,2),VRT(8,2),NT(2),NF1(2),NF2(2)
      COMMON/SYMINF/NSTART,NIRREP,IRREPA(255,2),DIRPRD(8,8)
C
      COMMON/DSYM/IRREPX,IPERT,NDT(2),NDF1(2),NDF2(2),
     &            IOFFIJ(8,2),IOFFAB(8,2),IOFFAI(8,2)
C
      COMMON /TIMEINFO/ TIMEIN, TIMENOW, TIMETOT, TIMENEW 
C
      DATA ZERO /0.D0/
C
C CONSTRUCT FIRST-ORDER DERIVATIVE AMPLITUDES
C FOR MBPT(2), THIS IS ALL WHAT IS REQUIRED, FOR
C ROHF WE NEED IN ADDITION THE FIRST-ORDER SINGLES
C AMPLITUDES WHILE FOR HIGHER ORDER MBPT WE 
C NEED SECOND, THIRD-ORDER DERIVATIVE AMPLITUDES
C AND FOR CC WE NEED TO SOLVE THE CPCC EQUATIONS
C WHICH DETERMINE THE DERIVATIVE AMPLITUDES
C
      CALL TIMER(1)
C
C CALCULATE DT2 SPIN CASE ABAB
C
      GRAD1=ZERO
      CALL DT2IJAB(ICORE,MAXCOR,IUHF,ANTI,GRAD1)
C
C FOR UHF AND ROHF CONSTRUCT ALSO DT2 FOR SPIN CASE AAAA AND BBBB
C
      IF(IUHF.EQ.1) THEN
C
       DO 10 ISPIN=1,2
C
        CALL DT1IJAB(ICORE,MAXCOR,ISPIN,ANTI,GRAD1)
C
10     CONTINUE
C
C FOR ROHF-MBPT(2) AND STANDARD ORBITALS, ITERATE
C
       IF(ROHF.AND.(.NOT.SEMI)) THEN
C
        CALL DT2ITER(ICORE,MAXCOR,ANTI,GRAD1)
C
       ENDIF
C
C FOR ROHF-MBPT(2) WE NEED IN ADDITION THE SINGLES
C
       IF(ROHF.OR.QRHF) THEN
C
        CALL DT1IA(ICORE,MAXCOR,ANTI,GRAD1)
C
       ENDIF
C
      ENDIF
C
C FOR SECOND ORDER ALL IS DONE
C
      CALL TIMER(1)
      write(*,6000) TIMENEW
6000  FORMAT(' Total derivatives of t(ij,ab) have been',
     &       ' calculated in ',f5.1,' seconds.')
C
      RETURN
      END 
