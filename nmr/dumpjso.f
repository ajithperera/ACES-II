      SUBROUTINE DUMPJSO(JSO,NCOORD,SCR)
C
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER DIRPRD 
      DOUBLE PRECISION JSO
C
      DIMENSION JSO(NCOORD,NCOORD),SCR(1)
C
      COMMON/SYMINF/NSTART,NIRREP,IRREPA(255,2),DIRPRD(8,8)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/PERT3/IXYZSYM(3)
C
      DATA IONE/1/
      DATA HALFM,ONE /-0.5D0,1.0D0/
      DATA TWO,TWOM,FOUR /2.D0,-2.D0,4.D0/
C
C C: VELOCITY OF LIGHT IN A.U.
C
      DATA C /137.035987D0/
C
C MPROTON: MASS OF PROTON IN A.U.
C
      DATA MPROTON /1836.152736D0/
C
C CONVERT: CONVERSION FROM A.U. TO SEC  (FOR TIME UNITS)
C
      DATA  CONVERT /2.4188843D-17/
C
      DATA PI /3.141592654D0/
C
C CONVERSION OF CALCULATED COUPLING TENSOR TO THE USUAL UNITS (HZ)
C
C   A FACTOR OF TWO ACCOUNTS FOR THE FACT THAT THE SUM RUNS ONLY OVER
C   N > N'. THE DIAGONAL ELEMENTS ARE THEREFORE NOT CORRECT BUT
C   ALSO OF NO INTEREST (AT LEAST AT THE MOMENT)
C
      FACT=TWOM/(FOUR*(MPROTON**2)*(C**4)*CONVERT*TWO*PI)

C
      OPEN(UNIT=82,FILE='JSO',STATUS='OLD',FORM='FORMATTED')
      REWIND(82)
C
      NATOMS=NCOORD/3
C
C CONVERT CHEMICAL SHIFT CONTRIBUTION TO P.P.M.
C
      CALL SSCAL(NCOORD*NCOORD,FACT,JSO,1)
C
C FOR CASES WITH SYMMETRY, TRANSFORM THE CHEMICAL SHIFT TENSORS
C BACK TO THE NON-SYMMETRIC REPRESENTATION
C
      IF(NIRREP.NE.1) THEN
C
       CALL ZERO(SCR,NCOORD*NCOORD)
       CALL TRAHES(JSO,SCR,SCR(1+IINTFP*NCOORD*NCOORD),
     &             SCR(1+2*IINTFP*NCOORD*NCOORD),NCOORD)
c YAU : old
c      CALL ICOPY(NCOORD*NCOORD*IINTFP,SCR,1,JSO,1)
c YAU : new
       CALL DCOPY(NCOORD*NCOORD,SCR,1,JSO,1)
c YAU : end
C
      ENDIF
C
      CALL GETREC(20,'JOBARC','NINDATOM',IONE,NUCIND)
      CALL GETREC(20,'JOBARC','MULTATOM',NUCIND,SCR)
      CALL GETREC(20,'JOBARC','NAMCOORD',IINTFP*3*NUCIND,SCR(1+NUCIND))
C
      write(6,6001)
6001  FORMAT(/,' MBPT(2) contribution to the paramagnetic part',
     &       ' of the SO contribution to J:',/)
C
C JPRI ALSO CONVERTS THE COUPLINGS TO THE REAL J (GIVEN IN HZ)
C BY MULTIPLYING WITH THE APPROPRIATE NUCLEAR G-FACTORS
C
      CALL JPRI(JSO,NCOORD,NUCIND,SCR,SCR(1+NUCIND),
     &          SCR(1+3*IINTFP*NUCIND),.TRUE.,.TRUE.)
C
      IOFF=0
      DO 100 I=1,NCOORD
C
        READ(82,5101) (SCR(J+IOFF),J=1,NCOORD)
5101    FORMAT(3F20.10)
C
        IOFF=IOFF+NCOORD
100   CONTINUE
C
C REWIND JSO FILE
C
      REWIND(82)
C
      CALL SAXPY(NCOORD*NCOORD,ONE,SCR,1,JSO,1)
C
      DO 200 I=1,NCOORD
C
        WRITE(82,5101) (JSO(I,J),J=1,NCOORD)
     &                 
200   CONTINUE
C
      CALL GETREC(20,'JOBARC','MULTATOM',NUCIND,SCR)
      CALL GETREC(20,'JOBARC','NAMCOORD',IINTFP*3*NUCIND,SCR(1+NUCIND))
C
       write(6,6002)
6002   FORMAT(/,' Total paramagnetic part of the',
     &        ' SO contribution to J:',/)
      CALL JPRI(CSH,NCOORD,NUCIND,SCR,SCR(1+NUCIND),
     &          SCR(1+3*IINTFP*NUCIND),.TRUE.,.FALSE.)
C
      RETURN
      END
