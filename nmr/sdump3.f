      SUBROUTINE SDUMP3(AODINT,BUF,BUF1,NSTART,NEND,IRREPX)
C
C THIS ROUTINE DUMPS TRANSFORMED INTEGRAL DERIVATIVES
C TO DISK. HERE, INTEGRALS FOR SYMMETRIC PERTURBATIONS
C OF TYPE IJIJ ARE HANDLED
C
CEND
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER DIRPRD,AOPOP,POP,VRT
C
      DIMENSION AODINT(1),BUF(1),BUF1(1),NSTART(8),NEND(8)
      DIMENSION IOFFVV(8,8),IOFFVO(8,8)
C
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/SYMINF/NDUMMY,NIRREP,IRREPA(255,2),DIRPRD(8,8)
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON/SYM/POP(8,2),VRT(8,2),NT(2),NF1(2),NF2(2)
      COMMON/AOPOPS/AOPOP(8)
C
      INDXF(I,J,N)=I+N*(J-1)
C
C INITIALIZE OFFSETS
C
      IOFF=1
C
C DETERMINE OFFSETS
C
      DO 1 IRREP=1,NIRREP
C
       IVV=0
       IVO=0
C
       DO 1 IRREPR=1,NIRREP 
C
        IRREPL=DIRPRD(IRREP,IRREPR)
        IOFFVV(IRREPL,IRREPR)=IVV
        IOFFVO(IRREPL,IRREPR)=IVO
        IVV=IVV+VRT(IRREPR,1)*VRT(IRREPL,1)
        IVO=IVO+VRT(IRREPL,1)*POP(IRREPR,1)
C
1     CONTINUE
C
C LOOP OVER ALL IRREPS
C
      DO 1000 IRREP1=1,NIRREP
C
       IRREP1R=DIRPRD(IRREP1,IRREPX)
       NSTARTR=NSTART(IRREP1R)
       NENDR=NEND(IRREP1R)
       NVRT1=VRT(IRREP1,1) 
C
       NSIZ3=0
       NSIZ2=0
C
       DO 2000 IRREP2=1,NIRREP
C
        IF(IRREP1.EQ.IRREP2) GO TO 2000
C
        IRREP12=DIRPRD(IRREP1,IRREP2)
        IRREP12R=DIRPRD(IRREP1R,IRREP2)
C
        NVRT2=VRT(IRREP2,1)
        NVRT22=NVRT2*NVRT2
        NVRT12=NVRT1*NVRT2
C
        NVRT3=NVRT22*NVRT1
C
        DO 100 IND=NSTARTR,NENDR
C
C GET INTEGRALS FOR GIVEN IND AS IRREP2,IRREP1,IRREP2
C
        CALL SCOPY(NVRT3,AODINT(IOFF),1,BUF,1)
        CALL SCOPY(NVRT3,AODINT(IOFF),1,BUF(1+NVRT3),1)
C
C REORDER THEM AS IRREP1,IRREP1,IRREP2,IRREP2
C
        IF(IRREP2.LT.IRREP1) THEN
         DO 3010 IP=1,NVRT2
          CALL SCOPY(NVRT12,BUF(IP),NVRT2,BUF1,1)
          CALL TRANSP(BUF1,BUF1(1+NVRT12),NVRT2,NVRT1)
          CALL SCOPY(NVRT12,BUF1(1+NVRT12),1,BUF(IP),NVRT2) 
3010     CONTINUE
         IOFFB=1+NVRT3
         DO 3011 IP=1,NVRT2
          CALL TRANSP(BUF(IOFFB),BUF1,NVRT1,NVRT2)
          CALL SCOPY(NVRT12,BUF1,1,BUF(IOFFB),1)
          IOFFB=IOFFB+NVRT12
3011     CONTINUE
         IOFFB=NVRT3
         DO 3012 IP=1,NVRT1
          CALL SCOPY(NVRT22,BUF(IOFFB+IP),NVRT1,BUF1,1)
          CALL TRANSP(BUF1,BUF1(1+NVRT22),NVRT2,NVRT2)
          CALL SCOPY(NVRT22,BUF1(1+NVRT22),1,BUF(IP+IOFFB),NVRT1)
3012     CONTINUE
        ELSE
         IOFFB=1
         DO 3013 IP=1,NVRT2
          CALL TRANSP(BUF(IOFFB),BUF1,NVRT2,NVRT1)
          CALL SCOPY(NVRT12,BUF1,1,BUF(IOFFB),1)
          IOFFB=IOFFB+NVRT12
3013     CONTINUE
         DO 3014 IP=1,NVRT2
          CALL SCOPY(NVRT12,BUF(IP),NVRT2,BUF1,1)
          CALL TRANSP(BUF1,BUF1(1+NVRT12),NVRT2,NVRT1)
          CALL SCOPY(NVRT12,BUF1(1+NVRT12),1,BUF(IP),NVRT2) 
3014    CONTINUE      
         IOFFB=NVRT3
         DO 3015 IP=1,NVRT1
          CALL SCOPY(NVRT22,BUF(IOFFB+IP),NVRT1,BUF1,1)
          CALL TRANSP(BUF1,BUF1(1+NVRT22),NVRT2,NVRT2)
          CALL SCOPY(NVRT22,BUF1(1+NVRT22),1,BUF(IP+IOFFB),NVRT1)
3015     CONTINUE
        ENDIF     
C
C THE ORDERING IS NOW :  (FASTEST TO SLOWEST) IRREP2,IRREP2; IRREP1,
C                                             FIXED OCC(IRREP1)
        LENGTH=NVRT2*NVRT2
        IF(LENGTH.NE.0) THEN
         DO 65 IQ=1,NVRT1
          IOFFABCI=INDXF(1,IQ,NVRT22)
          IDISABCI=IOFFVO(IRREP1,IRREP1R)+INDXF(IQ,IND,NVRT1)
          LOFFABCI=IOFFVV(IRREP2,IRREP2)
          CALL ULIST(BUF(IOFFABCI),BUF1,LENGTH,IDISABCI,LOFFABCI,
     &               1,1,IRREPX,330,2)
65       CONTINUE
        ENDIF
C
C THE ORDERING IS NOW :  (FASTEST TO SLOWEST) IRREP1,IRREP2; IRREP2,
C                                             FIXED OCC(IRREP1)
        LENGTH=NVRT2*NVRT1
        IF(LENGTH.NE.0) THEN
         DO 165 IQ=1,NVRT2
          IOFFABCI=INDXF(1,IQ,NVRT12)+NVRT3
          IDISABCI=IOFFVO(IRREP2,IRREP1R)+INDXF(IQ,IND,NVRT2)
          LOFFABCI=IOFFVV(IRREP1,IRREP2)
          CALL ULIST(BUF(IOFFABCI),BUF1,LENGTH,IDISABCI,LOFFABCI,
     &               1,IRREP12,IRREP12R,330,2)
165       CONTINUE
        ENDIF
C
        IOFF=IOFF+NVRT3
C
100    CONTINUE
C
2000    CONTINUE
C
C
1000  CONTINUE
C
      RETURN
      END
