      SUBROUTINE SDUMP2(AODINT,BUF,BUF1,NSTART,NEND,IRREPX)
C
C THIS ROUTINE DUMPS TRANSFORMED INTEGRAL DERIVATIVES
C TO DISK. HERE, INTEGRALS FOR SYMMETRIC PERTURBATIONS
C OF TYPE IIJJ ARE HANDLED
C
CEND
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER DIRPRD,AOPOP,POP,VRT
C
      DIMENSION AODINT(1),BUF(1),BUF1(1),NSTART(8),NEND(8)
      DIMENSION IOFFOO(8,8),IOFFVV(8,8),IOFFVO(8,8),IOFFOV(8,8)
C
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/SYMINF/NDUMMY,NIRREP,IRREPA(255,2),DIRPRD(8,8)
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON/SYM/POP(8,2),VRT(8,2),NT(2),NF1(2),NF2(2)
      COMMON/AOPOPS/AOPOP(8)
C
      INDXF(I,J,N)=I+N*(J-1)
C
      IOFF=1
C
C DETERMINE OFFSETS
C
      DO 1 IRREP=1,NIRREP
      IVO=0
      IVV=0
      DO 1 IRREPR=1,NIRREP
       IRREPL=DIRPRD(IRREPR,IRREP)
       IOFFVV(IRREPL,IRREPR)=IVV
       IOFFVO(IRREPL,IRREPR)=IVO
       IVV=IVV+VRT(IRREPR,1)*VRT(IRREPL,1)
       IVO=IVO+VRT(IRREPL,1)*POP(IRREPR,1)
1     CONTINUE
C
C LOOP OVER ALL IRREPS
C
      DO 1000 IRREP1=1,NIRREP
C
       IRREP1R=DIRPRD(IRREP1,IRREPX)
       NSTARTR=NSTART(IRREP1R)
       NENDR=NEND(IRREP1R)
       NVRT1=VRT(IRREP1,1) 
C
       NSIZ3=0
       NSIZ2=0
C
       DO 1010 IRREP2=1,NIRREP
C
        IF(IRREP1.NE.IRREP2) THEN
         NSIZ3=NSIZ3+VRT(IRREP1,1)*(VRT(IRREP2,1)+1)*
     &        VRT(IRREP2,1)/2
         NSIZ2=NSIZ2+(VRT(IRREP2,1)+1)*VRT(IRREP2,1)/2
        ENDIF
C
1010   CONTINUE
C
       DO 100 IND=NSTARTR,NENDR
C
        IOFF2=0
C
        DO 2000 IRREP2=1,NIRREP
C
         IF(IRREP1.EQ.IRREP2) GO TO 2000
C
         IRREP12=DIRPRD(IRREP1,IRREP2)
         IRREP12R=DIRPRD(IRREP1R,IRREP2)
C
         NVRT2=VRT(IRREP2,1)
         NVRT22=NVRT2*(NVRT2+1)/2
         NVRT12=NVRT1*NVRT2

C REORDER ADOINT ARRAY, BUT ONLY INTEGRALS WHICH BELONG TO
C IRREP (THIS IS DONE IN EXPND5)
C
        IOFFB=1
        DO 3000 JMO=1,NVRT1
         IOFFA=IOFF+(JMO-1)*NSIZ2+IOFF2
         CALL MATEXP2(NVRT2,AODINT(IOFFA),BUF(IOFFB))
         IOFFB=IOFFB+NVRT2*NVRT2
3000    CONTINUE
C
        IOFF2=IOFF2+NVRT22
C
        DO 3010 IP=1,NVRT2
         CALL SCOPY(NVRT12,BUF(IP),NVRT2,BUF1,1)
         CALL TRANSP(BUF1,BUF1(1+NVRT12),NVRT1,NVRT2)
         CALL SCOPY(NVRT12,BUF1(1+NVRT12),1,BUF(IP),NVRT2) 
3010    CONTINUE
C
C THE ORDERING IS NOW :     IRREP2,IRREP1; IRREP2, FIXED OCC(IRREP1R)
C
C
        LENGTH=NVRT1*NVRT2
        IF(LENGTH.NE.0) THEN
         DO 65 IQ=1,NVRT2
          IOFFABCI=INDXF(1,IQ,NVRT12)
          IDISABCI=IOFFVO(IRREP2,IRREP1R)+INDXF(IQ,IND,NVRT2)
          LOFFABCI=IOFFVV(IRREP2,IRREP1)
          CALL ULIST(BUF(IOFFABCI),BUF1,LENGTH,IDISABCI,LOFFABCI,
     &               1,IRREP12,IRREP12R,330,2)
65       CONTINUE
        ENDIF
C
2000    CONTINUE
C
        IOFF=IOFF+NSIZ3
C
100    CONTINUE
C
1000  CONTINUE
C
      RETURN
      END
