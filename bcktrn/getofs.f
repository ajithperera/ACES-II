

      SUBROUTINE GETOFS(EVECA,EVECB,IUHF,NBAS)
C
C COMPUTE OFFSETS FOR EACH IRREP AND PACK MATRIX
C
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION EVECA(1),EVECB(1)
      COMMON /AOPOPS/ AOPOP(8),MOPOP(8),NAO,NAOSPH,NMO
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /AOOFS2/ INDAO(8,2)
      IOFF=1
      IOFF20=1
      IOFF1=1
      DO 10 IRREP=1,NIRREP
       NUMMO=MOPOP(IRREP)
       NUMAO=AOPOP(IRREP)
       IOFF2=IOFF20
       DO 11 IORB=1,NUMMO
        CALL C_MEMMOVE(EVECA(IOFF1),EVECA(IOFF2),IFLTLN*NUMAO)
        IOFF1=IOFF1+NUMAO
        IOFF2=IOFF2+NAO
11     CONTINUE
       INDAO(IRREP,1)=IOFF
       IOFF=IOFF+NUMMO*NUMAO
       IOFF20=IOFF20+NUMAO+NUMMO*NAO
10    CONTINUE
      IF(IUHF.EQ.1)THEN
       IOFF=NAO*NMO+1
       IOFF20=1
       IOFF1=1
       DO 20 IRREP=1,NIRREP
        NUMAO=AOPOP(IRREP)
        NUMMO=MOPOP(IRREP)
        IOFF2=IOFF20
        DO 21 IORB=1,NUMMO
         CALL C_MEMMOVE(EVECB(IOFF1),EVECB(IOFF2),IFLTLN*NUMAO)
         IOFF1=IOFF1+NUMAO
         IOFF2=IOFF2+NAO
21      CONTINUE
        INDAO(IRREP,2)=IOFF
        IOFF=IOFF+NUMAO*NUMMO
        IOFF20=IOFF20+NUMAO+NUMMO*NAO
20     CONTINUE
      ELSE
       CALL ICOPY(NIRREP,INDAO(1,1),1,INDAO(1,2),1)
      ENDIF
      RETURN
      END
