      SUBROUTINE OSL2AAA(L,T,G,ISPIN,POPL,POPT,POP,NOCCSQ,
     $   DISSYW,DISSYT,NUMSYW,NUMSYT,LISTL,LISTT,IRREP,FACT)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DOUBLE PRECISION L 
      INTEGER DISSYT,DISSYW,DIRPRD,POPL,POPT,POP
      DIMENSION L(DISSYW,NUMSYW),T(DISSYT,NUMSYT),G(NOCCSQ)
      DIMENSION POPL(8),POPT(8),POP(8)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),DIRPRD(8,8)
C
      DATA ONEM,ONE,HALF /-1.0D0,1.D0,0.5D0/
C
      CALL FSGET(L,1,NUMSYW,2,IRREP,LISTL,'IIII')
C
      CALL FSGET(T,1,NUMSYT,1,IRREP,LISTT,'IIIA')
C
      JOFFL=1
      JOFFT=1
      IOFF=1
      DO 90 IRREPI=1,NIRREP
C
         NOCCL=POPL(IRREPI)
         NOCCT=POPT(IRREPI)
C
         IRREPJ=DIRPRD(IRREP,IRREPI)
         NOCCJ=POP(IRREPJ)
C
         IF(MIN(NOCCT,NOCCL,NOCCJ).NE.0) THEN
C
            CALL XGEMM('T','N',NOCCT,NOCCL,DISSYW*NOCCJ,FACT*HALF,
     &         T(1,JOFFT),NOCCJ*DISSYW,L(1,JOFFL),
     &         NOCCJ*DISSYW,ONE,G(IOFF),NOCCT)
         ENDIF
C
         JOFFT=JOFFT+NOCCT*NOCCJ
         JOFFL=JOFFL+NOCCL*NOCCJ
         IOFF=IOFF+NOCCL*NOCCT
 90   CONTINUE
C
      RETURN
      END
