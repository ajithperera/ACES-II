      SUBROUTINE OSL2AAB(T,L,T1,G,ISPIN,POPT1,POPL1,POPL2,VRT1,
     $   VRT2,NOCCSQ,DISSYW,DISSYT,NUMSYW,NUMSYT,LISTL,LISTT,IRREP,
     $   TMP,FACT,STRING)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      CHARACTER*4 STRING 
      DOUBLE PRECISION L
      INTEGER DISSYT, DISSYW, DIRPRD,POPT1,POPL1,POPL2,VRT1,VRT2
      DIMENSION L(DISSYW,NUMSYW),T(DISSYT,NUMSYT),G(NOCCSQ)
      DIMENSION TMP(*),T1(DISSYW*NUMSYW)
      DIMENSION POPT1(8),POPL1(8),POPL2(8),VRT1(8),VRT2(8)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),DIRPRD(8,8)
C
      DATA ONE,ONEM,TWO /1.0D0,-1.D0,2.D0/,HALF /0.5D0/
C
      CALL FSGET(L,1,NUMSYW,1,IRREP,LISTL,'IIII')
C
      CALL FSGET(T1,1,NUMSYT,1,IRREP,LISTT,STRING)
C
      IF(ISPIN.EQ.2) THEN 
         CALL SYMTR1(IRREP,POPL1,POPL2,DISSYW,L,TMP,TMP(1+DISSYW),
     &      TMP(1+2*DISSYW))
      ENDIF
      CALL SYMTRA2(IRREP,VRT1,VRT2,DISSYT,NUMSYT,T1,T)
C
      JOFFL=1
      JOFFT=1
      IOFF=1
      DO 90 IRREPI=1,NIRREP
C
         NOCCL=POPL1(IRREPI)
         NOCCT=POPT1(IRREPI)
C
         IRREPJ=DIRPRD(IRREP,IRREPI)
         NOCCJ=POPL2(IRREPJ)
C
         IF(MIN(NOCCL,NOCCT,NOCCJ).NE.0) THEN
C
            CALL XGEMM('T','N',NOCCT,NOCCL,DISSYW*NOCCJ,FACT,
     &         T(1,JOFFT),NOCCJ*DISSYW,L(1,JOFFL),      
     &         NOCCJ*DISSYW,ONE,G(IOFF),NOCCT)
         ENDIF
C
         JOFFL=JOFFL+NOCCJ*NOCCL
         JOFFT=JOFFT+NOCCJ*NOCCT
         IOFF=IOFF+NOCCT*NOCCL
 90   CONTINUE
C
      RETURN
      END
