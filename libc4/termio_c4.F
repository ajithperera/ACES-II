      SUBROUTINE TERMIO_C4
      IMPLICIT INTEGER (A-Z)
      LOGICAL YESNO,YESNO1
      COMMON /FLAGS/ IFLAGS(100)
      INTEGER USEC,FILE
      COMMON / / ICORE(1)
      COMMON /INCORE/ ICREC(2),USEC,IXT(2),IMOD(2)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /MACHSP2/MASK1,MASK2,ISHFSZ
      COMMON /FILES/ LUOUT,MOINTS
      COMMON /STARTS/ TBLOCK,WBLOCK
      COMMON /FILSPC/ ILNBUF,IPRCLN,IPRCWD
      COMMON /IOSTAT/ NOPBUF,NOPDSK
      COMMON /LISTS/ MOIO(10,500),MOIOWD(10,500),MOIOSZ(10,500),
     &               MOIODS(10,500),MOIOFL(10,500)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),NTOT(18)
      COMMON /IOPOS/ ICRSIZ,ICHCSZ,IOFF(2),LENREC
      COMMON /CACHEINF/ CACHNUM,CACHNMP1,CACHDIR(100),CACHPOS(100),
     &                  CACHFILE(100),CACHMOD(100),OLDEST
      UPACKR(I) =AND(I,MASK1)
      MOIOSIZ=5000
      DO 15 I=1,CACHNUM
       FILE=CACHFILE(I)
       IF(FILE.NE.0)THEN
        RECORD=UPACKR(CACHDIR(I))
        IPOS  =CACHPOS(I)
        CALL WRDIR_C4(FILE,RECORD,ICORE(IPOS),LENREC,CACHMOD(I))
       ENDIF
15    CONTINUE
      CALL PUTREC_C4(20,'JOBARC','MOIOVEC ',MOIOSIZ,MOIO)
      CALL PUTREC_C4(20,'JOBARC','MOIOWRD ',MOIOSIZ,MOIOWD)
      CALL PUTREC_C4(20,'JOBARC','MOIOSIZ ',MOIOSIZ,MOIOSZ)
      CALL PUTREC_C4(20,'JOBARC','MOIODIS ',MOIOSIZ,MOIODS)
      CALL PUTREC_C4(20,'JOBARC','MOIOFIL ',MOIOSIZ,MOIOFL)
      CALL PUTREC_C4(20,'JOBARC','ISYMTYP ',1000,ISYTYP)   
      CALL UPDMOI_C4(0,0,0,0,2,0)
      DO 10 I=50,54
       INQUIRE(UNIT=I,EXIST=YESNO,OPENED=YESNO1)
       IF(YESNO1) CALL CLOSMO_C4(I)
10    CONTINUE
      RETURN
      END
