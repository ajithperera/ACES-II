      SUBROUTINE OPNFIL_C4(IUNIT)
      CHARACTER*8 NAME(5)
      CHARACTER*80 FNAME
      LOGICAL EXISTS
      CHARACTER*2 ADDON(5)
      COMMON/FILSPC/IBUFLN,IPRCLN,IPRCWD
      COMMON/FSTRIPE/NUMSPLIT(5)
      DATA NAME /'MOINTS  ','GAMLAM  ','MOABCD  ','DERINT  ',
     &           'DERGAM  '/
      DATA ADDON/'  ','2 ','3 ','4 ','5 '/
      NSPLIT=NUMSPLIT(IUNIT)
      IF(NSPLIT.NE.0)THEN
       DO 333 I=1,NSPLIT
        CALL GFNAME(NAME(IUNIT)(1:6)//ADDON(I),FNAME,ILENGTH)
        INQUIRE(FILE=FNAME(1:ILENGTH),EXIST=EXISTS)
        IF(EXISTS)THEN
         IADD=(I-1)*5
         OPEN(UNIT=IUNIT+49+IADD,FILE=FNAME(1:ILENGTH),
     &        FORM='UNFORMATTED',ACCESS=
     &        'DIRECT',RECL=IPRCLN,STATUS='OLD')
        ELSE
         IADD=(I-1)*5
         OPEN(UNIT=IUNIT+49+IADD,FILE=FNAME(1:ILENGTH),
     &        FORM='UNFORMATTED',ACCESS=
     &        'DIRECT',RECL=IPRCLN,STATUS='NEW')
        ENDIF
333    CONTINUE
      ELSE
       CALL GFNAME(NAME(IUNIT),FNAME,ILENGTH)
       INQUIRE(FILE=FNAME(1:ILENGTH),EXIST=EXISTS)
       IF(EXISTS)THEN
        OPEN(UNIT=IUNIT+49,FILE=FNAME(1:ILENGTH),
     &       FORM='UNFORMATTED',ACCESS=
     &       'DIRECT',RECL=IPRCLN,STATUS='OLD')
       ELSE
        OPEN(UNIT=IUNIT+49,FILE=FNAME(1:ILENGTH),
     &       FORM='UNFORMATTED',ACCESS=
     &       'DIRECT',RECL=IPRCLN,STATUS='NEW')
       ENDIF
      ENDIF
      RETURN
      END
