      SUBROUTINE FETCH_C4(ZLIST,FILE,RECNUM,IWRDOFF,NWORDS)
      IMPLICIT INTEGER (A-Z)
      DIMENSION ZLIST(1)
      COMMON // ICORE(1)
      COMMON /CACHEINF/ CACHNUM,CACHNMP1,CACHDIR(100),CACHPOS(100),
     &                  CACHFILE(100),CACHMOD(100),OLDEST
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /MACHSP2/MASK1,MASK2 ,ISHFSZ
      COMMON /FILSPC/ ILNBUF,IPRCLN,IPRCWD
      COMMON /IOPOS/ ICRSIZ,ICHCSZ,IOFF(2),LENREC
      IPACK(I,J)=OR(J,ISHFT(I-49,ISHFSZ))
      UPACKR(I) =AND(I,MASK1)
      UPACKF(I) =AND(ISHFT(I,-ISHFSZ),MASK2)+49
      ITEST=IPACK(FILE,RECNUM)
      ILOC=ISRCHEQ_C4(CACHNUM,CACHDIR,1,ITEST)
      IF(ILOC.NE.CACHNMP1)THEN
       IADR=CACHPOS(ILOC)
       IPOS=IADR+IWRDOFF-1
       CALL ICOPY(NWORDS,ICORE(IPOS),1,ZLIST,1)
       RETURN
      ELSE
       IF(CACHMOD(OLDEST).NE.0)THEN
        IADR=CACHPOS(OLDEST)
        FILEOUT=UPACKF(CACHDIR(OLDEST))
        RECOUT =UPACKR(CACHDIR(OLDEST)) 
        CALL WRDIR_C4(FILEOUT,RECOUT,ICORE(CACHPOS(OLDEST)),
     &             LENREC,CACHMOD(OLDEST))
       ENDIF
       CALL RDDIR_C4(FILE,RECNUM,ICORE(CACHPOS(OLDEST)),LENREC,
     &            CACHMOD(OLDEST))
       CACHFILE(OLDEST)=FILE
       CACHDIR (OLDEST)=IPACK(FILE,RECNUM)
       IPOS=CACHPOS(OLDEST)+IWRDOFF-1
       CALL ICOPY(NWORDS,ICORE(IPOS),1,ZLIST,1)
       OLDEST=OLDEST+1
       IF(OLDEST.GT.CACHNUM)OLDEST=1
       RETURN
      ENDIF
      END
