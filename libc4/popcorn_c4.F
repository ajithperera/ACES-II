
      SUBROUTINE POPCORN_C4(MEMSIZ)
      IMPLICIT INTEGER (A-Z)
      INTEGER USEC
      COMMON /INCORE/ ICREC(2),USEC,IXT(2),IMOD(2)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /FILES/ LUOUT,MOINTS
      COMMON /FLAGS/ IFLAGS(100)
      COMMON /IOPOS/ ICRSIZ,ICHCSZ,IOFFX(2),LENREC
      COMMON /FILSPC/ IBUFLN,IPRCLN,IPRCWD
      COMMON /RECSIZE/ISCALE
      COMMON /ISTART/ I0
      COMMON /CACHEINF/ CACHNUM,CACHNMP1,CACHDIR(100),CACHPOS(100),
     &                  CACHFILE(100),CACHMOD(100),OLDEST
      CALL IZERO(CACHDIR,400)
      ICHCSZ=IFLAGS(37)
      CACHNUM=IFLAGS(44)
      CACHNMP1=CACHNUM+1
      ICRSIZ=MEMSIZ-CACHNUM*ICHCSZ
      LENREC=ICHCSZ
      IPRCWD=ICHCSZ
      IPRCLN=ICHCSZ*IINTLN/ISCALE
      IOFF=I0
      DO 10 I=1,CACHNUM
       CACHPOS(I)=IOFF
       IOFF=IOFF+LENREC
10    CONTINUE
      I0=IOFF
      RETURN
      END
