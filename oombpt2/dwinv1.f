      SUBROUTINE DWINV1(ICORE,MAXCOR,IUHF,LISTV)
      IMPLICIT INTEGER (A-Z)
      DIMENSION ICORE(MAXCOR)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
C
C DRIVER FOR FORMATION OF D1*I CONTRIBUTIONS TO V(1) EQUATION
C
C
C LOAD V(1) INCREMENT
C
      I000=1
      I010=I000+IINTFP*NT(1)
      CALL GETLST(ICORE(I000),1,1,1,1,LISTV)
      IF(IUHF.NE.0)THEN
       CALL GETLST(ICORE(I010),1,1,1,2,LISTV)
      ELSE
       I010=I000
      ENDIF
      I020=I010+IINTFP*NT(2)
C
C LOAD OCCUPIED-OCCUPIED BLOCK OF G MATRIX AND CALL GINL11
C
      I030=I020+IINTFP*NFMI(1)
      CALL GETLST(ICORE(I020),1,1,1,1,160)
      IF(IUHF.NE.0)THEN
       CALL GETLST(ICORE(I030),1,1,1,2,160)
      ELSE
       I030=I020
      ENDIF
      I040=I030+IINTFP*NFMI(2)
      MXCOR=MAXCOR-I040+1
      CALL DINV11(ICORE(I000),ICORE(I020),ICORE(I040),MXCOR,IUHF)
C
C LOAD VIRTUAL-VIRTUAL BLOCK OF G MATRIX AND CALL GINL12
C
      I030=I020+IINTFP*NFEA(1)
      CALL GETLST(ICORE(I020),1,1,1,3,160)
      IF(IUHF.NE.0)THEN
       CALL GETLST(ICORE(I030),1,1,1,4,160)
      ELSE
       I030=I020
      ENDIF
      I040=I030+IINTFP*NFEA(2)
      MXCOR=MAXCOR-I040+1

      CALL DINV12(ICORE(I000),ICORE(I020),ICORE(I040),MXCOR,IUHF)
C
C WRITE LAMBDA BACK TO DISK
C
      CALL PUTLST(ICORE(I000),1,1,1,1,LISTV)
      IF(IUHF.NE.0)THEN
       CALL PUTLST(ICORE(I010),1,1,1,2,LISTV)
      ENDIF
      RETURN
      END
