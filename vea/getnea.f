      SUBROUTINE GETNEA(NEA, SIRREP, ISPIN, IUHF)
C
      IMPLICIT INTEGER (A-Z)
      logical lefthand, excicore, singonly, DROPCORE, ADDST
      DIMENSION NS(8)
C
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON/EACALC/LEFTHAND, EXCICORE, SINGONLY, DROPCORE
      COMMON/COREINFO/IREPCORE, SPINCORE, IORBCORE, IORBOCC
      COMMON/STINFO/ITOTALS, STMODE, LISTST, STCALC, NSIZEST
C
      ADDST = .FALSE.
      IF (EXCICORE) THEN
         ADDST = ((STMODE .EQ.1) .AND. (ISPIN .EQ.SPINCORE))
      ENDIF
C
C FIRST FIND THE DIMENSION OF THE MATRICES
C
      CALL IZERO(NS, 8)
      NS(SIRREP) = 1
      IF (ADDST) THEN
         DSPIN = 3 - ISPIN
         MSPIN = 3 - DSPIN
         LENA = VRT(SIRREP, DSPIN)
         CALL GETLEN2(LENAA, IRPDPD(1, DSPIN), POP(1,DSPIN), NS(1))
         CALL GETLEN2(LENAB, IRPDPD(1,13), POP(1,MSPIN), NS(1))
         MSPIN = 3 - ISPIN
         LENB = VRT(SIRREP, ISPIN)
         CALL GETLEN2(LENBB, IRPDPD(1, ISPIN), POP(1,ISPIN), NS(1))
         CALL GETLEN2(LENBA, IRPDPD(1,13), POP(1,MSPIN), NS(1))
         NEA = LENA + LENAA + LENAB + LENB + LENBB + LENBA
      ELSE
         IF (IUHF.EQ.0) THEN
            CALL GETLEN(LENAB, VRT(1,1), VRT(1,1), POP(1,1), NS(1))
            LENAA = 0
         ELSE
            MSPIN = 3 - ISPIN
            CALL GETLEN2(LENAA, IRPDPD(1, ISPIN), POP(1,ISPIN), NS(1))
            CALL GETLEN2(LENAB, IRPDPD(1,13), POP(1,MSPIN), NS(1))
         ENDIF
         NEA = VRT(SIRREP, ISPIN) + LENAA + LENAB
      ENDIF
C
      RETURN
      END
