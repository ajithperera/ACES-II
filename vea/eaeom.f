C
C  THIS PROGRAM CALCULATES ELECTRON AFFINITIES AND CORRESPONDING
C  RIGHT AND LEFT EIGENVECTORS ACCORDING TO THE EOM-CC METHOD
C
C  CODED BY Marcel Nooijen, 1993
C
      PROGRAM EAEOM
      IMPLICIT INTEGER (A-Z)
      PARAMETER (MAXORD = 100)
      DOUBLE PRECISION ROOT,  EIGVAL, OSCSTR, R, P, TSSTGEN,
     $   TEADAVID, TEADIR, STFAC, COREIP
      LOGICAL EMINFOL, EVECFOL, LEFTHAND, EXCICORE,
     $   SINGONLY, DROPCORE
C
      COMMON / / ICORE(1)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /FILES/ LUOUT,MOINTS
      COMMON /INFO /  NOCCO(2),NVRTO(2)
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),DIRPRD(8,8)
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /FLAGS/ IFLAGS(100)
      COMMON /ISTART/ I0,ICRSIZ
      COMMON /SINFO/ NS(8), SIRREP
      COMMON/SLISTS/LS1IN, LS1OUT, LS2IN(2,2), LS2OUT(2,2)
      COMMON/LISTDAV/LISTC, LISTHC, LISTH0
      COMMON/LISTF/LISTFJA, LISTFAJ, LISTFAB, LISTFIJ,
     $   LISTF0, NDIMFLST(2,4)
      COMMON/LISTU/LISTUIJ, LISTUAB, LISTUAI
      COMMON/DIPSYM/IRREPDIP(3)
      COMMON/LISTDIP/DIPOO(2), DIPOV(2), DIPVV(2)
      COMMON/LISTDENS/DENSOO(2), DENSOV(2), DENSVV(2)
      COMMON/EXTINF/NDIMR,IOLDEST
      COMMON/EXTINF2/ROOT
      COMMON/EXTINF3/IROOT,LOCROOT,ITROOT
      COMMON/ROOTS/EIGVAL(100,8,3), OSCSTR(100,8,3)
      COMMON/EXTRAP/MAXEXP,NREDUCE,NTOL,NSIZEC
      COMMON/RMAT/ R(10000), P(10000)
      COMMON/CNVRGE/EMINFOL,EVECFOL
      COMMON/EACALC/LEFTHAND, EXCICORE, SINGONLY, DROPCORE
      COMMON/EAINFO/NUMROOT(8,3)
      COMMON/COREINFO/IREPCORE, SPINCORE, IORBCORE, IORBOCC
      COMMON/IPCORE/COREIP
      COMMON/FACSTA/STFAC
      COMMON/STINFO/ITOTALS, STMODE, LISTST, STCALC, NSIZEST
      COMMON /TIMSUB/ TSSTGEN, TEADAVID, TEADIR
      COMMON/STARTEA/STARTI(8), STARTB(8,8)
C
      CALL CRAPSI(ICORE,IUHF,0)
      MAXCOR = ICRSIZ
      CALL INITEA(ICORE(I0), MAXCOR, IUHF, CALC)
C     
      IF (CALC .EQ. 1) THEN
         CALL CHECKEA(ICORE(I0), MAXCOR, IUHF)
      ELSEIF (CALC .EQ. 2) THEN
         CALL EIGDAV(ICORE(I0), MAXCOR, IUHF)
      ELSEIF (CALC .EQ. 3) THEN
         Print*, "I am here"
         CALL CHECKEA(ICORE(I0), MAXCOR, IUHF)
         CALL EIGDAV(ICORE(I0), MAXCOR, IUHF)
      ENDIF
C
      CALL EXITEA(ICORE(I0), MAXCOR, IUHF)
C
      call aces_fin
      STOP
      END
