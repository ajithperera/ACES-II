      FUNCTION ELYPF(ROA,ROB,GRDAA,GRDAB,GRDBB)
C     
C     Determine the value of the xalpha functional.
C     
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C     
      COMMON /PAR/ PI,PIX4
      COMMON /CNST/ X1,X2,X3,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14,X15
      COMMON /FRAC/ F1,F2,F3,F4,F5,F6,F7,F8,F9,F10,F11,F12,F13,F14,F15
C
      RO=ROA+ROB
      IF(RO.LT.1.D-20)THEN
         ELYPF=0.D+00
         RETURN
      ENDIF
      RO13=RO**(-F2)
      ROAB=ROA*ROB
      CRO13=X6*RO13
      DRO13=X7*RO13
      DEN=1.D+00+DRO13
      DELTA=CRO13+DRO13/DEN
      ABOMEG=X8*EXP(-CRO13)*(RO**(-F5))/DEN
      ROABD9=F4*ROAB
      TMP1=1.D+00-3.D+00*DELTA
      TMP2=DELTA-11.D+00
      TRM1=-(X12*ROAB)/(DEN*RO)
      TRM2=-X10*ABOMEG*ROAB*(ROA**F3+ROB**F3)
      DAA=-ABOMEG*(ROABD9*(TMP1-TMP2*ROA/RO)-ROB*ROB)
      DAB=-ABOMEG*(ROABD9*(47.D+00-7.D+00*DELTA)-F1*RO*RO)
      DBB=-ABOMEG*(ROABD9*(TMP1-TMP2*ROB/RO)-ROA*ROA)
      ELYPF=TRM1+TRM2+DAA*GRDAA+DAB*GRDAB+DBB*GRDBB
C     
      RETURN
      END
