      SUBROUTINE FMC(MVAR,XVAR,EXPMX,FMCH)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      M=MVAR
      X=XVAR
      EXPMX= EXP(-X)
      IF(X - 20.0) 10,10,20
C     X LESS THAN OR EQUAL TO 20.0
10    A=M
      A = A+0.5
      TERM=1.0/A
      PTLSUM=TERM
      DO 11 I=2,200
      A=A+1.0
      TERM = TERM*X/A
      PTLSUM=PTLSUM+TERM
      IF(TERM/PTLSUM-1.E-10) 12, 11, 11
11    CONTINUE
      WRITE(6,999) M, X
12    FMCH=0.5*PTLSUM*EXPMX
      RETURN
C     X GREATER THAN 20.0.
20    A=M
      XD=1.0/X
      B=A+0.5
      A=A-0.5
      APPROX = 0.88622692*(SQRT(XD)*XD**M)
      IF (M) 21, 23, 21
21    DO 22 I=1,M
      B=B-1.0
22    APPROX=APPROX*B
23    FIMULT=0.5*EXPMX*XD
      FIPROP=FIMULT/APPROX
      TERM=1.0
      PTLSUM=TERM
      NOTRMS=X
      NOTRMS=NOTRMS+M
      DO 24 I=2,NOTRMS
      TERM=TERM*A*XD
      PTLSUM=PTLSUM+TERM
      IF ( ABS(TERM*FIPROP/PTLSUM) - 1.E-10) 25,25,24
24    A=A-1.0
      WRITE(6,999) M, X
25    FMCH=APPROX-FIMULT*PTLSUM
      RETURN
999   FORMAT (24H0NO CONVERGENCE FOR FMCH, I6, E16.9)
      END
