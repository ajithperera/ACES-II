      SUBROUTINE DMPDEN(DOOA,DOOB,DVVA,DVVB,CORE,
     1                  NOCA,NOCB,NVRTA,NVRTB,IUHF,IINTFP)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      DIMENSION DOOA(NOCA),DOOB(NOCB),DVVA(NVRTA),DVVB(NVRTB),
     1          CORE(1)
C
      WRITE(6,1000)
 1000 FORMAT(' @DMPDEN-I, Dumping diagonal elements of density ')
C
      LEN = MAX(NOCA,NOCB,NVRTA,NVRTB)
C
      IF(IUHF.EQ.0)THEN
C
      CALL VADD(DOOA,DOOA,DOOB,NOCA,1.0D+00)
      CALL   ZERO(CORE,LEN*LEN)
c YAU : old
c     CALL ICOPY(NOCA*IINTFP,DOOA,1,CORE,1)
c YAU : new
      CALL DCOPY(NOCA,DOOA,1,CORE,1)
c YAU : end
      CALL PUTLST(CORE,1,1,2,1,160)
C
      CALL VADD(DVVA,DVVA,DVVB,NVRTA,1.0D+00)
      CALL   ZERO(CORE,LEN*LEN)
c YAU : old
c     CALL ICOPY(NVRTA*IINTFP,DVVA,1,CORE,1)
c YAU : new
      CALL DCOPY(NVRTA,DVVA,1,CORE,1)
c YAU : end
      CALL PUTLST(CORE,1,1,2,3,160)
C
      ELSE
      CALL   ZERO(CORE,LEN*LEN)
c YAU : old
c     CALL ICOPY(NOCA*IINTFP,DOOA,1,CORE,1)
c YAU : new
      CALL DCOPY(NOCA,DOOA,1,CORE,1)
c YAU : end
      CALL PUTLST(CORE,1,1,2,1,160)
C
      CALL   ZERO(CORE,LEN*LEN)
c YAU : old
c     CALL ICOPY(NOCB*IINTFP,DOOB,1,CORE,1)
c YAU : new
      CALL DCOPY(NOCB,DOOB,1,CORE,1)
c YAU : end
      CALL PUTLST(CORE,1,1,2,2,160)
C
      CALL   ZERO(CORE,LEN*LEN)
c YAU : old
c     CALL ICOPY(NVRTA*IINTFP,DVVA,1,CORE,1)
c YAU : new
      CALL DCOPY(NVRTA,DVVA,1,CORE,1)
c YAU : end
      CALL PUTLST(CORE,1,1,2,3,160)
C
      CALL   ZERO(CORE,LEN*LEN)
c YAU : old
c     CALL ICOPY(NVRTB*IINTFP,DVVB,1,CORE,1)
c YAU : new
      CALL DCOPY(NVRTB,DVVB,1,CORE,1)
c YAU : end
      CALL PUTLST(CORE,1,1,2,4,160)
      ENDIF
C
      RETURN
      END
