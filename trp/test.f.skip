      CALL ZERO(ICORE(I070),LENABC)
      CALL ZERO(ICORE(I010),IOFFT2 - I010)
      CALL S1S223(ICORE(ISTART),ICORE(I070),ICORE(I010),IADBLK,IADW,
     1            1,2,I,J,K,IRPI,IRPJ,IRPK,IRPIJ,IRPIK,IRPJK,IRPIJK,
     1            IUHF,1,LCCSD_T)
      IF(NONHF)THEN
      CALL ZERO(ICORE(I110),LENABC)
      CALL ZERO(ICORE(I010),IOFFT2 - I010)
      CALL S1S223(ICORE(ISTART),ICORE(I110),ICORE(I010),IADBLK,IADW,
     1            1,2,I,J,K,IRPI,IRPJ,IRPK,IRPIJ,IRPIK,IRPJK,IRPIJK,
     1            IUHF,2,LCCSD_T)

      CALL VADD(ICORE(I070),ICORE(I070),ICORE(I110),LENABC, 1.0D+00)
     ENDIF 

     IF (ICLLVL.EQ.21) CALL XSCAL(LENABC,2.0D+00,ICORE(I000),1)

     IF (.NOT. FINAL)
     & CALL RMD314(ICORE(I070),ICORE(I060),LENABC,DIJK)

      IF (IUHF.EQ.0) THEN
         CALL DCOPY(LENABC,ICORE(I070),1,ICORE(I100),1)
         CALL SC1SC2(ICORE(I100),ICORE(I070),LENABC/IINTFP,
     &               IADBLK,IRPIJK)
      END IF

      IF(INT1.OR.INT2.OR.IDRLVL.GT.0)THEN
      CALL SYMTRW2(ICORE(I000),ICORE(I010),ICORE(ISTART),
     1             IADBLK,IADW2,IRPIJK,1,2)

      IF (IUHF.EQ.0) THEN
         CALL DCOPY(LENABC,ICORE(I000),1,ICORE(I090),1)
         CALL SC1SC2(ICORE(I090),ICORE(I000),LENABC,IADBLK,IRPIJK)
         CALL E4TIJK(ICORE(I090),ICORE(I060),LENABC,DIJK,
     &               E4TAAA, __FILE__)
         IF (ICLLVL.EQ.21) CALL XSCAL(LENABC,2.0D+00,ICORE(I090),1)
         CALL VADD(ICORE(I000),ICORE(I000),ICORE(I090),LENABC,1.0D+00)
      END IF

      IF(IUHF.EQ.0)THEN
       CALL VADD(ICORE(I000),ICORE(I000),ICORE(I090),LENABC,-1.0D+00)
        IF(ICLLVL.EQ.21)THEN
         CALL SSCAL(LENABC,0.5D+00,ICORE(I090),1)
        ENDIF
      ENDIF

      IF(ICLLVL.EQ.21)THEN
      CALL SSCAL(LENABC,2.0D+00,ICORE(I070),1)
      CALL SSCAL(LENABC,2.0D+00,ICORE(I100),1)
      ENDIF
      CALL SYMTRW2(ICORE(I070),ICORE(I080),ICORE(ISTART),
     1             IADBLK,IADW2,IRPIJK,1,2)
C
       IF (.NOT. FINAL) THEN

           CALL VADD(ICORE(I070),ICORE(I000),ICORE(I070),LENABC
     &         ,1.0D+00)
            CALL VADD(ICORE(I080),ICORE(I010),ICORE(I080),IOFFT2-I010
     &         ,1.0D+00)
            IF(IUHF.EQ.0)THEN
               CALL VADD(ICORE(I100),ICORE(I090),ICORE(I100),LENABC
     &            ,1.0D+00)
            ENDIF
      ENDIF 
      CALL VADD(ICORE(I000),ICORE(I000),ICORE(I070),LENABC
     &         ,1.0D+00)
      CALL VADD(ICORE(I010),ICORE(I010),ICORE(I080),IOFFT2-I010
     &         ,1.0D+00)
      CALL SSCAL(LENABC     ,0.5D+00,ICORE(I000),1)
      CALL SSCAL(IOFFT2-I010,0.5D+00,ICORE(I010),1)






