      SUBROUTINE DOT32(DOOA,DOOB,T3C,T3D,LENT3,
     1                 IRPI,IRPJ,IRPK,
     1                 I,J,K,NOCA,NOCB,JFLAG)
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION DOOA(NOCA),DOOB(NOCB),T3C(LENT3),T3D(LENT3),
     1                 SDOT
#include "maxbasfn.par"
C
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     1                DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYM/    POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF2AA,
     1                NF1BB,NF2BB
      COMMON /INFO/   NOCCO(2),NVRTO(2)
C
      COMMON /ACTORB/ ABSVRT(MAXBASFN,8,2),ABSOCC(MAXBASFN,8,2)
C
C     ROUTINE TO COMPUTE CONTRIBUTION OF T3 AAB TO DIAGONAL
C     ELEMENTS OF OCCUPIED-OCCUPIED BLOCK OF RELAXED DENSITY MATRIX.
C
C                           ABC   ABC
C     DOO(I,I) = -  SUM    T     T
C                  A<B<C    IJK   IJK
C                  J < K
C
      ISPIN1 = 1
      ISPIN2 = 2
C
      KACT = ABSOCC(K,IRPK,ISPIN2)
      DOOB(KACT) = DOOB(KACT) - SDOT(LENT3,T3C,1,T3D,1)
      IF(JFLAG.NE.0) RETURN
      IACT = ABSOCC(I,IRPI,ISPIN1)
      DOOA(IACT) = DOOA(IACT) - SDOT(LENT3,T3C,1,T3D,1)
      JACT = ABSOCC(J,IRPJ,ISPIN1)
      DOOA(JACT) = DOOA(JACT) - SDOT(LENT3,T3C,1,T3D,1)
C
      RETURN
      END
