      SUBROUTINE FORM_HT3C2(T3,W,SCR1,SCR2,SCR3,ICORE,IADBLK,IADW,
     &                      IADW2,NLEFT,IRPI,IRPJ,IRPK,IRPIJ,IRPIK,
     &                      IRPJK,IRPIJK,I,J,K,ICLLVL,IUHF,IMODE,
     &                      LAMBDA,NONHF)
      IMPLICIT INTEGER (A-Z)
      LOGICAL LAMBDA
      LOGICAL NONHF
      DOUBLE PRECISION T3(1),W(1),ICORE(1)
      DOUBLE PRECISION SCR1(1),SCR2(1),SCR3(1)
      DIMENSION IADT3(8)
      DIMENSION IADFVO(8),LENFVO(8)
      DIMENSION OOOVAD(8,4),LENINT(8,4)
      DIMENSION LEN(8,8),IADBLK(8),LENBLK(8)
      DIMENSION IADT2(8),LENT2(8)
      DIMENSION IADV(8),LENV(8)
      DIMENSION IADW(8),LENW(8)
      DIMENSION IADW2(8)

C
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     1                DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYM/    POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF2AA,
     1                NF1BB,NF2BB
      COMMON /INFO/   NOCCO(2),NVRTO(2)
C
      COMMON /T3OFF/  IOFFVV(8,8,10),IOFFOO(8,8,10),IOFFVO(8,8,4)
      COMMON /T2ILIS/ LIST2I1,LIST2I2,LIST2I3

      ISTART = 1
      IF (NONHF) THEN
      CALL T2FT3_HT3C2(T3,W,ICORE(ISTART),IADBLK,IADW2,NLEFT,
     &                 IRPI,IRPJ,IRPK,IRPIJ,IRPIK,IRPJK,
     &                 IRPIJK,I,J,K,ICLLVL,IUHF,0,.FALSE.)
      ENDIF 
C
C     --- D2T2 = W T3 ---
C
      CALL T2T3_HT3C2_1(T3,W,ICORE(ISTART),IADBLK,IADW2,IRPI,
     &                  IRPJ,IRPK,IRPIJ,IRPIK,IRPJK,IRPIJK,I,
     &                  J,K,IUHF,SCR1,SCR2,SCR3,.FALSE.)
C
      CALL T2T3_HT3C2_2(T3,W,ICORE(ISTART),IADBLK,IADW2,IRPI,
     &                  IRPJ,IRPK,IRPIJ,IRPIK,IRPJK,IRPIJK,I,
     &                  J,K,IUHF,SCR1,SCR2,SCR3,.FALSE.)

      RETURN 
      END 
