      SUBROUTINE DMPDEN(ICORE,MAXCOR,IUHF)
C
C CALCULATES REDUCED ONE-PARTICLE CC DENSITY AND WRITES IT
C TO JOBARC
C
CEND
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION ONE,ONEM,ZILCH
      DIMENSION ICORE(MAXCOR)
      CHARACTER*8 LABELD(2)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/SYM/POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON/SYMINF/NSTART,NIRREP,IRREPY(255,2),DIRPRD(8,8)
      COMMON/INFO/NOCCO(2),NVRTO(2)
C
      DATA ONE,ONEM,ZILCH/1.0D0,-1.0D0,0.0D0/
      DATA LABELD/'RELDENSA','RELDENSB'/
C
      I000=1
      I010=I000+IINTFP*(NFMI(1)+IUHF*NFMI(2))
      I020=I010+IINTFP*(NFEA(1)+IUHF*NFEA(2))
      I030=I020+IINTFP*(NT(1)+IUHF*NT(2))
      I040=I030+IINTFP*(NT(1)+IUHF*NT(2))
      I050=I040+IINTFP*(NT(1)+IUHF*NT(2))
      MXCOR=MAXCOR-I040+1
      CALL GSDEN(ICORE(I000),ICORE(I010),ICORE(I020),ICORE(I030),
     &           190,90,144,44,ONE,ICORE(I040),MXCOR,IUHF,.TRUE.)  
      NBAS=NOCCO(1)+NVRTO(1)
      IOFFOO=I000
      IOFFVV=I010
      IOFFVO=I020
      IOFFOV=I030
      DO 10 ISPIN=1,1+IUHF
       IOFFO=1
       IOFFV=NOCCO(ISPIN)+1
       CALL ZERO(ICORE(I050),NBAS*NBAS)
       DO 20 IRREP=1,NIRREP
        NOCC=POP(IRREP,ISPIN)
        NVRT=VRT(IRREP,ISPIN)
        CALL BLKCPY(ICORE(IOFFOO),NOCC,NOCC,ICORE(I050),NBAS,NBAS,
     &              IOFFO,IOFFO)
        CALL BLKCPY(ICORE(IOFFVV),NVRT,NVRT,ICORE(I050),NBAS,NBAS,
     &              IOFFV,IOFFV)
        CALL BLKCPY(ICORE(IOFFVO),NVRT,NOCC,ICORE(I050),NBAS,NBAS,
     &              IOFFV,IOFFO)
        CALL TRANSP(ICORE(IOFFOV),ICORE(I040),NOCC,NVRT)
        CALL BLKCPY(ICORE(I040),NOCC,NVRT,ICORE(I050),NBAS,NBAS,
     &              IOFFO,IOFFV)
        IOFFO=IOFFO+NOCC
        IOFFV=IOFFV+NVRT
        IOFFOO=IOFFOO+IINTFP*NOCC*NOCC
        IOFFVV=IOFFVV+IINTFP*NVRT*NVRT
        IOFFVO=IOFFVO+IINTFP*NVRT*NOCC
        IOFFOV=IOFFOV+IINTFP*NVRT*NOCC
20     CONTINUE
       IF(IUHF.EQ.0)CALL SSCAL(NBAS*NBAS,2.0D0,ICORE(I050),1)
C
C SYMMETRIZE REDUCED CCSD ONE-ELECTRON DENSITY MATRIX
C (NECESSARY SINCE VDINT PROCESSES ONLY THE UPPER TRIANGULAR MATRIX)
C
       CALL SYMMET2(ICORE(I050),NBAS)
       CALL PUTREC(20,'JOBARC',LABELD(ISPIN),IINTFP*NBAS*NBAS,
     &             ICORE(I050))
       CALL PUTREC(20,'JOBARC','IINTERMA',IINTFP*NBAS*NBAS,
     &             ICORE(I050))
10    CONTINUE
C
      RETURN
      END
