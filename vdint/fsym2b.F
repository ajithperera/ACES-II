      SUBROUTINE FSYM2B(IRREPX,FAOA,FAOB,NBAST,IPRINT,FSOA,
     &                  FSOB,NIR)
C
C TRANSFORMS THE NON-SYMMETRIC FOCK MATRIX DERIVATIVES
C FROM THE PRIMITVE AO TO THE SYMMETRY-ADAPTED AO BASIS
C
CEND
C
C  MAY/91 JG
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER AND,OR,XOR
      LOGICAL SHARE
      LOGICAL SCF,NONHF
C
      PARAMETER (LUCMD = 5, LUPRI = 6)
#include "baslims.par"
#include "mxcent.par"
      DIMENSION FSOA(1),FSOB(1)
      COMMON /SHELLSi/ KMAX,
     &                NHKT(MXSHEL),   KHKT(MXSHEL), MHKT(MXSHEL),
     &                ISTBAO(MXSHEL), NUCO(MXSHEL), JSTRT(MXSHEL),
     &                NSTRT(MXSHEL),  MST(MXSHEL),  NCENT(MXSHEL),
     &                NRCO(MXSHEL), NUMCF(MXSHEL),
     &                NBCH(MXSHEL),   KSTRT(MXSHEL)
      COMMON /SHELLS/ CENT(MXSHEL,3), SHARE(MXSHEL)
      COMMON /PINCOM/ IPIND(MXCORB), IBLOCK(MXCORB), INDGEN(MXCORB)
      COMMON /SYMMET/ FMULT(0:7), PT(0:7),
     &                MAXLOP, MAXLOT, MULT(0:7), ISYTYP(3),
     &                ITYPE(8,36), NPARSU(8), NPAR(8), NAOS(8),
     &                NPARNU(8,8), IPTSYM(MXCORB,0:7),
     &                IPTCNT(3*MXCENT,0:7), NCRREP(0:7),
     &                IPTCOR(MXCENT*3), NAXREP(0:7), IPTAX(3),
     &                IPTXYZ(3,0:7)
      DIMENSION FAOA(NBAST*(NBAST+1)/2,0:NIR),
     &          FAOB(NBAST*(NBAST+1)/2,0:NIR)
      COMMON/METHOD/IUHF,SCF,NONHF
      COMMON/BASSYM/NBAS(8),NBASIS,NBASSQ,NBASTT
      COMMON/LSYM/NLENQ(8),NLENT(8)
C
      DATA AZERO,ONE,TWO /0.D0,1.0D0,2.D0/
C
      IBTAND(I,J) = AND(I,J)
      IBTOR(I,J)  = OR(I,J)
      IBTSHL(I,J) = ISHFT(I,J)
      IBTSHR(I,J) = ISHFT(I,-J)
      IBTXOR(I,J) = XOR(I,J)
C
      CALL ZERO(FSOA,NLENT(IRREPX))
      IF(IUHF.NE.0) CALL ZERO(FSOB,NLENT(IRREPX))
C
C  LOOP OVER ALL IRREPS 
C
      ISOFF=0
      ISTR=1
      DO 100 IREPA = 0, MAXLOP
       IREPB=IBTXOR(IRREPX-1,IREPA)
       NORBI=NAOS(IREPA+1)
       NORBJ=NAOS(IREPB+1)
       IF(IREPA.LE.IREPB) GO TO 110
       IF(MIN(NORBI,NORBJ).EQ.0) GOTO 110
       JSTR=1
       DO 99 IRREP=1,IREPB
        JSTR=JSTR+NAOS(IRREP)
99     CONTINUE
       DO 200 I=ISTR,ISTR+NORBI-1
        IA=IBTSHR(IPIND(I),16)
        NA=IBTSHR(IPIND(I),8) - IA*256
        IOFF=KSTRT(IA)
        MULA=ISTBAO(IA)
        INDA=IOFF + NA
        DO 300 J=JSTR,JSTR+NORBJ-1
         IB=IBTSHR(IPIND(J),16)
         NB=IBTSHR(IPIND(J),8) - IB*256
         JOFF=KSTRT(IB)
         NHKTB=NHKT(IB)
         KHKTB=KHKT(IB)
         MULB=ISTBAO(IB)
         MAB=IBTOR(MULA,MULB)
         ISOFF=ISOFF + 1
         FAIJ=AZERO
         FBIJ=AZERO
         FACT=ONE
         DO 400 ISYMOP = 0, MAXLOT
          FAC = PT(IBTAND(ISYMOP,IREPB))
          INDB = JOFF + NB
          IF(INDA.GE.INDB) THEN
           FAC=FAC*PT(IBTAND(IRREPX-1,ISYMOP))
          ENDIF
          INDM=MAX(INDA,INDB)
          IND=(INDM*(INDM-3))/2+INDA+INDB
          FAIJ=FAIJ+FAC*FAOA(IND,ISYMOP)
          IF(IUHF.NE.0) THEN
           FBIJ=FBIJ+FAC*FAOB(IND,ISYMOP)
          ENDIF
400      CONTINUE
         FSOA(ISOFF)=FAIJ*FACT
         IF(IUHF.NE.0) FSOB(ISOFF)=FBIJ*FACT
300     CONTINUE
200    CONTINUE
110   CONTINUE
      ISTR=ISTR+NORBI
100   CONTINUE
C
      RETURN
      END
