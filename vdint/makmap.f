      SUBROUTINE MAKMAP(IMAP,NCOORD,IRREPX,IRREPY,IRREPZ,
     *                  ITRANSX,ITRANSY,ITRANSZ,TRAINV)
      IMPLICIT INTEGER(A-Z)
      INTEGER AND,OR,XOR
      LOGICAL TRAINV
C
      DIMENSION IMAP(NCOORD)
C
      COMMON/SYMINF/NSTART,NIRREP,IRREPA(255,2),DIRPRD(8,8)
      COMMON/PERT/NTPERT,NPERT(8),IIPERT(8),IXYZ(6),ITRANS(3),NUCIND
C
      IF(TRAINV)THEN
C
       IOFF=0
       ICOUNT=0
       DO 1 IRREP=1,NIRREP
        DO 2 IP=1,NPERT(IRREP)
         ICOUNT=ICOUNT+1
         IF(((IRREP.NE.IRREPX).OR.(IP.NE.ITRANSX)).AND.
     &      ((IRREP.NE.IRREPY).OR.(IP.NE.ITRANSY)).AND.
     &      ((IRREP.NE.IRREPZ).OR.(IP.NE.ITRANSZ))) THEN
          IOFF=IOFF+1
          IMAP(ICOUNT)=IOFF
         ELSE
          IMAP(ICOUNT)=0
         ENDIF
2       CONTINUE
1      CONTINUE
C
      ELSE
C
       DO 3 IP=1,NCOORD
        IMAP(IP)=IP
3      CONTINUE
C 
      ENDIF
C
      RETURN
      END
