      SUBROUTINE UAIINOOC(IRREPX,IOFFX,NX,FIJA,UAIA,ICORE,
     &                    MXCOR,IUHF)
C
C THIS ROUTINE COMPUTES THE CONTRIBUTIONS:
C
C      FD(I,J) =  SUM U(E,M) (<MI||EJ> - <EI||MJ>) (ISPIN=1)
C
C      FD(i,j) =  SUM U(e,m) (<mi||ej> - <ei||mj>) (ISPIN=2)
C
C NOTE THAT THIS ROUTINE DEALS WITH COMPLEX PERTURBATIONS AND
C THAT IN THIS CASE THE COMPLEX CONJUGATE IS THE NEGATIVE OF THE
C ORIGINAL (U(E,M)* = - U(E,M)). THERE IS NO SPIN COUPLING.
C
CEND
C

      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION ONE,UAIA,FIJA,ONEM,AZERO
      DIMENSION FIJA(100),UAIA(1000),ICORE(MXCOR)
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
C
      DATA ONE /1.0D0/,AZERO,ONEM/0.D0,-1.D0/
C
      IF(IUHF.EQ.0)THEN
C
C SPIN ADAPTED RHF CODE
C
C FOR RHF THIS REDUCES TO
C
C      SUM U(E,M) (-<Mi||Je> + <Ei||Jm>)
C
C  - P_(I,J) SUM U(E,M) <Em||Ij> 
C
       LISTW=10
       DISSIZ=IRPDPD(IRREPX,ISYTYP(1,LISTW)) 
       NUMDIS=IRPDPD(IRREPX,ISYTYP(2,LISTW)) 
       I000=1
       I010=I000+IINTFP*NUMDIS*DISSIZ
       CALL GETLST(ICORE(I000),1,NUMDIS,1,IRREPX,LISTW)
       DO 121 IPERT=IOFFX+1,NX
        CALL GETLST(ICORE(I010),IPERT,1,1,IRREPX,182)
        CALL SYMTRA(IRREPX,VRT(1,1),POP(1,1),1,ICORE(I010),UAIA) 
        CALL ZERO(FIJA,IRPDPD(IRREPX,21))
        CALL XGEMM('N','N',DISSIZ,1,NUMDIS,ONE,ICORE(I000),DISSIZ,
     &             UAIA,NUMDIS,AZERO,FIJA,DISSIZ)
        CALL ASYMMET(IRREPX,POP(1,1),FIJA,ICORE(I010),
     &               IRPDPD(IRREPX,21))
        CALL GETLST(ICORE(I010),IPERT,1,1,IRREPX,176)
        CALL SAXPY(IRPDPD(IRREPX,21),ONE,FIJA,1,ICORE(I010),1)
        CALL PUTLST(ICORE(I010),IPERT,1,1,IRREPX,176)
121    CONTINUE
      ELSEIF(IUHF.NE.0)THEN
       call errex
       DO 10 ISPIN=1,2
        LISTW1=6+ISPIN
c        DO 20 IRREP=1,NIRREP
        NDSZ1=IRPDPD(IRREPX,ISYTYP(1,LISTW1))
        NDSZF=IRPDPD(IRREPX,20+ISPIN)
        NDIS1=IRPDPD(IRREPX,ISYTYP(2,LISTW1))
C
C DO FIRST PART 2 U(E,M) I(IE,JM)
C
C THE FACTOR OF TWO IS OBTAINED IN THE SYMMET6 CALL
C
        I000=1
        I001=1+IINTFP*NDSZ1*NDIS1
        I010=I000+IINTFP*NDSZF*NDIS1
        I020=I010+IINTFP*NDIS1*NDSZ1
        CALL GETLST(ICORE(I001),1,NDIS1,2,IRREPX,LISTW1)
        CALL SYMEXP2(IRREPX,POP(1,ISPIN),NDIS1,ICORE(I000))
        DO 21 IPERT=IOFFX+1,NX
         CALL GETLST(UAIA,IPERT,1,1,IRREPX,181+ISPIN)
         CALL ZERO(FIJA,IRPDPD(IRREPX,20+ISPIN))
         CALL ASYMMET(IRREPX,POP(1,ISPIN),FIJA,ICORE(I010), 
     &                IRPDPD(IRREPX,20+ISPIN))
         CALL GETLST(ICORE(I010),IPERT,1,1,IRREPX,175+ISPIN)
         CALL SAXPY(IRPDPD(IRREPX,20+ISPIN),ONE,FIJA,1,ICORE(I010),1)
         CALL PUTLST(ICORE(I010),IPERT,1,1,IRREPX,175+ISPIN)
21      CONTINUE
C
c20      CONTINUE
10     CONTINUE
      ENDIF
      RETURN
      END
