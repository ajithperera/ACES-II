      SUBROUTINE ROHFDF(ICORE,MAXCOR)
C
C  THIS ROUTINE COMPLETES THE CALCULATION
C  OF THE FOCK MATRIX DERIVATIVES IN THE 
C  CASE OF ROHF WAVE FUNCTIONS.
C
CEND
C
C  JUNE/91 JG
C 
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER DIRPRD,POP,VRT,XYZSYM
      LOGICAL GEOM,FIELD,THIRD,MAGN,SPIN
C
      DIMENSION ICORE(MAXCOR)
C
      COMMON/BASSYM/NBAS(8),NBASIS,NBASSQ,NBASTT
      COMMON/SYMINF/NSTART,NIRREP,IRREPA(255,2),DIRPRD(8,8)
      COMMON/SYM/POP(8,2),VRT(8,2),NT(2),NF1(2),NF2(2)
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),NJUNK(18)
      COMMON/PERT/NTPERT,NPERT(8),IPERT(8),XYZSYM(3),IJUNK(7)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/PERT2/FIELD,GEOM,THIRD,MAGN,SPIN
C
C FIRST, WRITE LISTS FOR U(I,J)^chi AND U(a,b)^chi
C
       MAXSCR=MAXCOR/IINTFP 
C
       CALL FILLU(ICORE,MAXSCR)
C
C LOOP OVER ALL IRREPS
C
        DO 1000 IRREP=1,NIRREP
C
C DETERMINE THE NUMBER OF PERTURBATIONS
C
        IOFFF=0
        NFX=0
C
        IF(.NOT.FIELD) THEN
         NFX=NFX+NPERT(IRREP)
        ENDIF
C
C CHECK ELECTRICAL FIELD COMPONENTS
C
        DO 10 IXYZ=1,3
         IF(XYZSYM(IXYZ).EQ.IRREP) NFX=NFX+1
10      CONTINUE
C
C ALLOCATE MEMORY FOR FIRST STEP
C
        IUAIA=1
        IFAIA=IUAIA+MAX(IRPDPD(IRREP,9),IRPDPD(IRREP,10))*IINTFP
        IEND=IFAIA+MAX(IRPDPD(IRREP,9),IRPDPD(IRREP,10))*IINTFP
        MXCOR1=MAXCOR+1-IEND
C
        CALL UAIINVO(IRREP,IOFFF,NFX,ICORE(IFAIA),
     &               ICORE(IUAIA),ICORE(IEND),MXCOR1,1)
C
C FORM THE TOTAL DERIVATIVES OF THE FOCK MATRICES \partial f(pq) /\partial chi
C
c        ISAIA=IEND
c        IFFAI=ISCR+IINTFP*MAX(IRPDPD(IRREP,19),IRPDPD(IRREP,20),
c     &                        IRPDPD(IRREP,21),IRPDPD(IRREP,22))
c        IEND=IFFAI+IINTFP*MAX(IRPDPD(1,9),IRPDPD(1,10))
C
        IFIJA=IFAIA
        IFFAI=IFIJA+MAX(IRPDPD(IRREP,21),IRPDPD(IRREP,22))*IINTFP
        IFFIJ=IFFAI+MAX(NT(1),NT(2))*IINTFP
        IUUIJ=IFFIJ+IRPDPD(1,21)*IINTFP
        IEVAL=IUUIJ+IRPDPD(IRREP,21)*IINTFP
        IEND=IEVAL+NBASIS*IINTFP
        
C
        CALL DFIJ(IRREP,IOFFF,NFX,ICORE(IFIJA),ICORE(IUAIA),
     &            ICORE(IFFAI),ICORE(IEND), 
     &            ICORE(IUUIJ),ICORE(IFFIJ),ICORE(IEVAL))
C
        IFABA=IFIJA
        ISAIA=IFABA+MAX(IRPDPD(IRREP,19),IRPDPD(IRREP,20))*IINTFP
        IFFAI=ISAIA+IINTFP*MAX(IRPDPD(IRREP,9),IRPDPD(IRREP,10))
        IFFAB=IFFAI+MAX(IRPDPD(1,9),IRPDPD(1,10))*IINTFP
        IUUAB=IFFAB+IRPDPD(1,20)*IINTFP
        IEVAL=IUUAB+IRPDPD(IRREP,20)*IINTFP
        IEND=IEVAL+NBASIS*IINTFP
C
        CALL DFAB(IRREP,IOFFF,NFX,ICORE(IFABA),ICORE(IUAIA),
     &            ICORE(ISAIA),ICORE(IFFAI),ICORE(IEND),
     %            ICORE(IUUAB),ICORE(IFFAB),ICORE(IEVAL))
C
        IFAIA=IFABA
        ISIJA=IFAIA+MAX(IRPDPD(IRREP,9),IRPDPD(IRREP,10))*IINTFP
        ISABA=ISIJA+MAX(IRPDPD(IRREP,21),IRPDPD(IRREP,22))*IINTFP
        IFFAIA=ISABA+MAX(IRPDPD(IRREP,19),IRPDPD(IRREP,20))*IINTFP
        IFFIJA=IFFAIA+MAX(IRPDPD(1,9),IRPDPD(1,10))*IINTFP
        IFFABA=IFFIJA+MAX(IRPDPD(1,21),IRPDPD(1,22))*IINTFP
        IEVA=IFFABA+MAX(IRPDPD(1,19),IRPDPD(1,20))*IINTFP
        IEND=IEVA+IINTFP*NBASIS
C
        CALL DFAI(IRREP,IOFFF,NFX,ICORE(IFAIA),ICORE(IUAIA),
     &            ICORE(ISIJA),ICORE(ISABA),ICORE(IEVA),
     &            ICORE(IFFAIA),ICORE(IFFIJA),ICORE(IFFABA),
     &            ICORE(IEND))
C
1000  CONTINUE
C
C  ALL DONE
C
      RETURN
C
      END
