      SUBROUTINE ADDIA1(DOO,AIVO,FAI)
C
C   THIS ROUTINE CALCULATES THE FOLLOWING CONTRIBUTIONS TO THE
C   INTERMEDIATES
C
C -   I(A,I) <=  SUM M f(A,M) D(M,I)     (NON-HF)
C
CEND
C
C CODED MAY/91 JG
C
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      DIMENSION DOO(1),AIVO(1),FAI(1)
      LOGICAL DENS,GRAD,QRHF,NONHF,ROHF,SEMI,CANON,TRIP1,TRIP2,
     &        GABCD,RELAXED,TRULY_NONHF
      INTEGER DIRPRD,POP,VRT
      DIMENSION I0FAI(2),I0FAE(2),I0FMI(2),I0OO(2),I0VV(2),I0VO(2)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/INFO/NOCCO(2),NVRTO(2)
      COMMON/SYMINF/NSTART,NIRREP,IRREPA(255,2),DIRPRD(8,8)
      COMMON/DERIV/DENS,GRAD,QRHF,NONHF,ROHF,SEMI,CANON,TRIP1,
     &             TRIP2,GABCD,RELAXED,TRULY_NONHF
CJDW KKB stuff
      COMMON /SHIFT/ ISHIFT
C     COMMON /SYM/   POP(8,2),VRT(8,2),NT(2),NF1(2),NF2(2)
      COMMON /SYM2/  POP(8,2),VRT(8,2),NT(2),NF1(2),NF2(2)
CJDW END
C
      DATA ONE,ONEM /1.0D+0, -1.0D+0/
C
C  GET THE FOCK MATRICES
C
CJDW ISHIFT is added for KKB
      CALL GETLST(FAI,1,1,1,5,93 + ISHIFT)
      CALL GETLST(FAI(1+NT(1)),1,1,1,6,93 + ISHIFT)    
CJDW END
  
C
      I0OO(1)=1
      I0VV(1)=1
      I0VO(1)=1
      I0OO(2)=1+NF1(1)
      I0VV(2)=1+NF2(1)
      I0VO(2)=1+NT(1)
C
C   LOOP OVER ALL SPINS
C
      DO 1000 ISPIN=1,2
C
C    CALCULATE SECOND CONTRIBUTION TO - I(A,I)
C
C    - I(A,I) <=  SUM E f(A,M) D(M,I)
C
       IOFFI=I0VO(ISPIN)
       IOFFD=I0OO(ISPIN)
       IOFFF=I0VO(ISPIN)
C
       DO 400 IRREP=1,NIRREP
C
        NOCC=POP(IRREP,ISPIN)
        NVRT=VRT(IRREP,ISPIN)
C
        IF(MIN(NOCC,NVRT).NE.0) THEN
C
         CALL XGEMM('N','N',NVRT,NOCC,NOCC,ONE,FAI(IOFFF),NVRT,
     &              DOO(IOFFD),NOCC,ONE,AIVO(IOFFI),NVRT)
        ENDIF
C
C  UPDATE OFFSETS
C
        IOFFI=IOFFI+NOCC*NVRT
        IOFFD=IOFFD+NOCC*NOCC
        IOFFF=IOFFF+NVRT*NOCC
C
400    CONTINUE
C
1000  CONTINUE
C
      RETURN
      END
