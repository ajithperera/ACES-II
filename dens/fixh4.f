      SUBROUTINE FIXH4(ICORE,MAXCOR,IUHF)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER DISDSH
      LOGICAL MBPT2,MBPT3,M4DQ,M4SDQ,M4SDTQ,CCD,QCISD,CCSD,UCC
      INTEGER DIRPRD
C
      DIMENSION ICORE(MAXCOR)
C
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/METH/MBPT2,MBPT3,M4DQ,M4SDQ,M4SDTQ,CCD,QCISD,CCSD,UCC
      COMMON/SYMINF/NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
C
      DATA HALF,ONE /0.5D0,1.0D0/
C
C TAKE NO ACTION FOR MBPT(2) AND MBPT(3)
C
      IF(MBPT2.OR.MBPT3) RETURN
C
C LOOP OVER ALL H4 LISTS
C
      ISKIP=2-IUHF
      DO 10 IOFFSET=1,6,ISKIP
C
       NSIZE=IDSYMSZ(1,ISYTYP(1,253+IOFFSET),ISYTYP(2,253+IOFFSET))
       I001=1
       IF(CCD.OR.QCISD.OR.CCSD) THEN
        I002=I001+IINTFP*NSIZE
       ELSE
        I002=I001
       ENDIF
       CALL GETALL(ICORE(I001),NSIZE,1,253+IOFFSET)
       CALL SSCAL(NSIZE,HALF,ICORE(I001),1)
       IF(CCD.OR.QCISD.OR.CCSD) THEN
        IOFF1=I001
        IOFF2=I002
        DO 11 IRREP=1,NIRREP
         NUMDSH=IRPDPD(IRREP,ISYTYP(2,253+IOFFSET))
         DISDSH=IRPDPD(IRREP,ISYTYP(2,253+IOFFSET))
         CALL TRANSP(ICORE(IOFF1),ICORE(IOFF2),DISDSH,NUMDSH)
         IOFF1=IOFF1+IINTFP*NUMDSH*DISDSH
         IOFF2=IOFF2+IINTFP*NUMDSH*DISDSH
11      CONTINUE
       ENDIF
       CALL PUTALL(ICORE(I002),NSIZE,1,253+IOFFSET)
C
10    CONTINUE

      RETURN
      END
