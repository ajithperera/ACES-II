



      SUBROUTINE FORMZ(XIA,EVAL,POP,VRT,NOCC)
C
C  THIS ROUTINE FORMS THE ELEMENTS OF THE OCCUPIED-VIRTUAL BLOCK
C  OF THE DENSITY MATRIX
C 
CEND
C
C CODED JULY/90 JG
C
      IMPLICIT DOUBLE PRECISION(A-H,O-Z)
      INTEGER POP,VRT,DIRPRD
      DIMENSION XIA(1),EVAL(1),POP(8),VRT(8)
      COMMON/SYMINF/NSTART,NIRREP,IRREPA(255,2),DIRPRD(8,8)
C
      IND=0
      IOFFP=0
      IOFFV=NOCC
      DO 10 IRREP=1,NIRREP
       NOCCI=POP(IRREP)
       NVRTI=VRT(IRREP)
       DO 5 I=1,NOCCI
        INDI=I+IOFFP
        DO 5 IA=1,NVRTI
        INDA=IA+IOFFV
        IND=IND+1
        XIA(IND)=XIA(IND)/(EVAL(INDI)-EVAL(INDA))
5      CONTINUE 
       IOFFP=IOFFP+NOCCI
       IOFFV=IOFFV+NVRTI
10    CONTINUE
      RETURN
      END
