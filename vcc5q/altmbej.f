      SUBROUTINE ALTMBEJ(CORE,MAXCOR,IUHF)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER POP,VRT,DIRPRD
      DIMENSION CORE(1)
C
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYM/    POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON /INFO/   NOCA,NOCB,NVRTA,NVRTB
      COMMON /T3OFF/  IOFFVV(8,8,10),IOFFOO(8,8,10),IOFFVO(8,8,4)
C
      WRITE(6,1000)
 1000 FORMAT(' @ALTMBEJ-I, Altering the mbej lists. ')
C
      DO  100 ISPIN=1,IUHF+1
C
C     54,55
C
      LEN = 0
      DO   10 IRREP=1,NIRREP
      LEN = LEN + IRPDPD(IRREP,8+ISPIN) * IRPDPD(IRREP,8+ISPIN)
   10 CONTINUE
C
      I000 = 1
      I010 = I000 + LEN
C
      NEED = IINTFP * I010
      IF(NEED.GT.MAXCOR)THEN
      WRITE(6,1020) NEED,MAXCOR
 1020 FORMAT(' @ALTMBEJ-I, Insufficient memory. Need ',I15,' . Got ',
     1       I15)
      STOP 'ALTMBEJ'
      ENDIF
C
      CALL GETALL(CORE(I000),LEN,1,53+ISPIN)
      CALL VMINUS(CORE(I000),LEN)
      CALL PUTALL(CORE(I000),LEN,1,53+ISPIN)
  100 CONTINUE
C
      DO  200 ISPIN=1,IUHF+1
C
C     56,57
C
      LEN = 0
      DO  110 IRREP=1,NIRREP
      LEN = LEN + IRPDPD(IRREP,8+ISPIN) * IRPDPD(IRREP,11-ISPIN)
  110 CONTINUE
C
      I000 = 1
      I010 = I000 + LEN
C
      NEED = IINTFP * I010
      IF(NEED.GT.MAXCOR)THEN
      WRITE(6,1020) NEED,MAXCOR
      STOP 'ALTMBEJ'
      ENDIF
C
      CALL GETALL(CORE(I000),LEN,1,55+ISPIN)
c     CALL VMINUS(CORE(I000),LEN)
      CALL PUTALL(CORE(I000),LEN,1,55+ISPIN)
  200 CONTINUE
C
      DO  300 ISPIN=1,IUHF+1
C
C     58,59
C
      LEN = 0
      DO  210 IRREP=1,NIRREP
      LEN = LEN + IRPDPD(IRREP,10+ISPIN) * IRPDPD(IRREP,10+ISPIN)
  210 CONTINUE
C
      I000 = 1
      I010 = I000 + LEN
C
      NEED = IINTFP * I010
      IF(NEED.GT.MAXCOR)THEN
      WRITE(6,1020) NEED,MAXCOR
      STOP 'ALTMBEJ'
      ENDIF
C
      CALL GETALL(CORE(I000),LEN,1,57+ISPIN)
      CALL VMINUS(CORE(I000),LEN)
      CALL PUTALL(CORE(I000),LEN,1,57+ISPIN)
  300 CONTINUE
C
      RETURN
      END
