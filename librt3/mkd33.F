      SUBROUTINE MKD33(D3,EVAL,IADBLK,IRPIJK,
     1                 NOCA,NOCB,NVRTA,NVRTB)
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION D3(1),EVAL(NOCA+NVRTA,2)
      DIMENSION IADBLK(8)
C
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     1                DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYM/    POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF2AA,
     1                NF1BB,NF2BB
      COMMON /INFO/   NOCCO(2),NVRTO(2)
C
#include "maxbasfn.par"
      COMMON /ACTORB/ ABSVRT(MAXBASFN,8,2),ABSOCC(MAXBASFN,8,2)
      COMMON /T3OFF/  IOFFVV(8,8,10),IOFFOO(8,8,10),IOFFVO(8,8,4)
C
      INDEX(I) = I*(I-1)/2
C
      DO 1150 IRPC=1,NIRREP
      IRPAB = DIRPRD(IRPC,IRPIJK)
C
      IF(IRPAB.NE.1)THEN
C
      DO 1120 IRPB=2,NIRREP
      IRPA =  DIRPRD(IRPAB,IRPB)
      IF(IRPA.GT.IRPB) GOTO 1120
C
      IRPBC = DIRPRD(IRPB,IRPC)
      IRPAC = DIRPRD(IRPA,IRPC)
C
      IBLKAB = IOFFVV(IRPB,IRPAB,2)
C
      IOFFD3 = IADBLK(IRPC)  - 1 + IBLKAB
C
      DO 1000 C=1,VRT(IRPC,1)
      DO  990 B=1,VRT(IRPB,2)
      DO  980 A=1,VRT(IRPA,2)
C
      D3(IOFFD3 + (C-1)*IRPDPD(IRPAB,2) + (B-1)*VRT(IRPA,2) + A) =
     1 EVAL(NOCB+ABSVRT(A,IRPA,2),2)    + 
     1 EVAL(NOCB+ABSVRT(B,IRPB,2),2)    +
     1 EVAL(NOCA+ABSVRT(C,IRPC,1),1)
  980 CONTINUE
  990 CONTINUE
 1000 CONTINUE
C
 1120 CONTINUE
C
      ELSE
C
C     IRPAB = 1 (IE IRPA = IRPB)
C
      DO 1130 IRPB=1,NIRREP
      IRPA = IRPB
C
      IRPBC = DIRPRD(IRPB,IRPC)
      IRPAC = DIRPRD(IRPA,IRPC)
C
      IBLKAB = IOFFVV(IRPB,IRPAB,2)
      IOFFD3 = IADBLK(IRPC)  - 1 + IBLKAB
C
      DO 2000 C=1,VRT(IRPC,1)
      DO 1990 B=2,VRT(IRPB,2)
      DO 1980 A=1,B-1
C
      D3(IOFFD3 + (C-1)*IRPDPD(IRPAB,2) + INDEX(B-1) + A) =
     1 EVAL(NOCB+ABSVRT(A,IRPA,2),2)    + 
     1 EVAL(NOCB+ABSVRT(B,IRPB,2),2)    +
     1 EVAL(NOCA+ABSVRT(C,IRPC,1),1)
 1980 CONTINUE
 1990 CONTINUE
 2000 CONTINUE
C
 1130 CONTINUE
C
      ENDIF
C
 1150 CONTINUE
      RETURN
      END
