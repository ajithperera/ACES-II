      SUBROUTINE AT2IAB(CORE,LIST,IRREPX,IND)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER POP,VRT,DIRPRD
      DIMENSION CORE(1)
C
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     1                DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYM/    POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF2AA,
     1                NF1BB,NF2BB
C
C     LIST   - List to be altered.
C     IRREPX - Overall symmetry of list.
C     IND    - Parameter to determine what sort of transposition :
C
C              If IND is 0 (Alpha,Beta) ---> (Beta,Alpha)
C              Otherwise   (Beta,Alpha) ---> (Alpha,Beta)
CEND
C
      IF(IND.EQ.0)THEN
      WRITE(6,1000) LIST
      ELSE
      WRITE(6,1010) LIST
      ENDIF
 1000 FORMAT(' @AT2IAB-I, List ',I4,' AB --> BA. ')
 1010 FORMAT(' @AT2IAB-I, List ',I4,' BA --> AB. ')
C
      IF(IND.EQ.0)THEN
C
      DO   10 IRPIJ = 1,NIRREP
      IRPAB = DIRPRD(IRPIJ,IRREPX)
      I000 = 1
      I010 = I000 + MAX0(IRPDPD(IRPAB,13),IRPDPD(IRPIJ,14))
      I020 = I010 + MAX0(IRPDPD(IRPAB,13),IRPDPD(IRPIJ,14))
      I030 = I020 + MAX0(IRPDPD(IRPAB,13),IRPDPD(IRPIJ,14))
      CALL GETLST(CORE(I030),1,IRPDPD(IRPIJ,14),1,IRPIJ,LIST)
      CALL SYMTR3(IRPAB,VRT(1,1),VRT(1,2),
     1            IRPDPD(IRPAB,13),IRPDPD(IRPIJ,14),
     1            CORE(I030),CORE(I000),CORE(I010),CORE(I020))
      CALL PUTLST(CORE(I030),1,IRPDPD(IRPIJ,14),2,IRPIJ,LIST)
   10 CONTINUE
C
      ELSE
C
      DO  110 IRPIJ = 1,NIRREP
      IRPAB = DIRPRD(IRPIJ,IRREPX)
      I000 = 1
      I010 = I000 + MAX0(IRPDPD(IRPAB,13),IRPDPD(IRPIJ,14))
      I020 = I010 + MAX0(IRPDPD(IRPAB,13),IRPDPD(IRPIJ,14))
      I030 = I020 + MAX0(IRPDPD(IRPAB,13),IRPDPD(IRPIJ,14))
      CALL GETLST(CORE(I030),1,IRPDPD(IRPIJ,14),1,IRPIJ,LIST)
      CALL SYMTR3(IRPAB,VRT(1,2),VRT(1,1),
     1            IRPDPD(IRPAB,13),IRPDPD(IRPIJ,14),
     1            CORE(I030),CORE(I000),CORE(I010),CORE(I020))
      CALL PUTLST(CORE(I030),1,IRPDPD(IRPIJ,14),2,IRPIJ,LIST)
  110 CONTINUE
C
      ENDIF
C
      RETURN
      END
