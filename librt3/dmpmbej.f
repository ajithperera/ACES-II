      SUBROUTINE DMPMBEJ(CORE,MAXCOR,IUHF)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER DIRPRD,VRT,POP,DISSIZ
      LOGICAL DUMP
      DIMENSION CORE(1)
      COMMON /SYMINF/ NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYM/    POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF2AA,
     1                NF1BB,NF2BB
C
      DUMP = .FALSE.
C
      DO 40 ISPIN=1,IUHF+1
      LIST = 53 + ISPIN
cYAU - less output...
c      write(6,*) ' DMPMBEJ-I, list ',LIST
      DO 30 IRREP=1,NIRREP
      DISSIZ = IRPDPD(IRREP,18 + ISPIN)
      NDIS   = IRPDPD(IRREP,20 + ISPIN)
      DO 20 IDIS =1,NDIS
      CALL GETLST(CORE,IDIS,1,2,IRREP,LIST)
      CALL VMINUS(CORE,DISSIZ)
      CALL PUTLST(CORE,IDIS,1,2,IRREP,LIST)
C
      IF(DUMP)THEN
      IOFF = 1
      DO 10 IRPR=1,NIRREP
      IRPL  = DIRPRD(IRPR,IRREP)
      ISIZL = VRT(IRPL,ISPIN)
      ISIZR = VRT(IRPR,ISPIN)
      CALL OUTPUT(CORE(IOFF),1,ISIZL,1,ISIZR,ISIZL,ISIZR,1)
      IOFF = IOFF + ISIZL * ISIZR
   10 CONTINUE
      ENDIF
   20 CONTINUE
   30 CONTINUE
   40 CONTINUE
C
      IF(DUMP)THEN
      DO 140 ISPIN=1,IUHF+1
      IF(ISPIN.EQ.1)THEN
      ISPIN1 = 1
      ISPIN2 = 2
      ELSE
      ISPIN1 = 2
      ISPIN2 = 1
      ENDIF
      LIST = 55 + ISPIN
      write(6,*) ' DMPMBEJ-I, list ',LIST
      DO 130 IRREP=1,NIRREP
      DISSIZ = IRPDPD(IRREP,13)
      NDIS   = IRPDPD(IRREP,14)
      DO 120 IDIS =1,NDIS
      CALL GETLST(CORE,IDIS,1,2,IRREP,LIST)
C
      IOFF = 1
      DO 110 IRPR=1,NIRREP
      IRPL  = DIRPRD(IRPR,IRREP)
      ISIZL = VRT(IRPL,ISPIN1)
      ISIZR = VRT(IRPR,ISPIN2)
      CALL OUTPUT(CORE(IOFF),1,ISIZL,1,ISIZR,ISIZL,ISIZR,1)
      IOFF = IOFF + ISIZL * ISIZR
  110 CONTINUE
  120 CONTINUE
  130 CONTINUE
  140 CONTINUE
      ENDIF
C
      DO 240 ISPIN=1,IUHF+1
      LIST = 57 + ISPIN
      write(6,*) ' DMPMBEJ-I, list ',LIST
      DO 230 IRREP=1,NIRREP
      DISSIZ = IRPDPD(IRREP,18 + ISPIN)
      NDIS   = IRPDPD(IRREP,23 - ISPIN)
      DO 220 IDIS =1,NDIS
      CALL GETLST(CORE,IDIS,1,2,IRREP,LIST)
      CALL VMINUS(CORE,DISSIZ)
      CALL PUTLST(CORE,IDIS,1,2,IRREP,LIST)
C
      IF(DUMP)THEN
      IOFF = 1
      DO 210 IRPR=1,NIRREP
      IRPL  = DIRPRD(IRPR,IRREP)
      ISIZL = VRT(IRPL,ISPIN)
      ISIZR = VRT(IRPR,ISPIN)
      CALL OUTPUT(CORE(IOFF),1,ISIZL,1,ISIZR,ISIZL,ISIZR,1)
      IOFF = IOFF + ISIZL * ISIZR
  210 CONTINUE
      ENDIF
  220 CONTINUE
  230 CONTINUE
  240 CONTINUE
      RETURN
      END
