      SUBROUTINE EXPSC2(T3,W,IADBLK,IADW,IRPIJK)
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION T3(1),W(1)
      DIMENSION IADBLK(8),IADW(8)
C
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     1                DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON /SYM/    POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF2AA,
     1                NF1BB,NF2BB
      COMMON /INFO/   NOCCO(2),NVRTO(2)
C
      COMMON /T3OFF/  IOFFVV(8,8,10),IOFFOO(8,8,10),IOFFVO(8,8,4)
C
      INDEX(I) = I*(I-1)/2
C
      DO 1150 IRPC=1,NIRREP
      IRPAB = DIRPRD(IRPC,IRPIJK)
C
      IF(IRPAB.NE.1)THEN
C
      DO 1120 IRPB=2,NIRREP
      IRPA =  DIRPRD(IRPAB,IRPB)
      IF(IRPA.GT.IRPB) GOTO 1120
C
      IRPBC = DIRPRD(IRPB,IRPC)
      IRPAC = DIRPRD(IRPA,IRPC)
C
      IBLKAB = IOFFVV(IRPB,IRPAB,1)
C
      IOFFT3 = IADBLK(IRPC)  - 1 + IBLKAB
      IOFFBC =   IADW(IRPBC) - 1 + 
     1           IOFFVV(IRPC,IRPBC,5) * VRT(IRPA,1)
      IOFFAC =   IADW(IRPAC) - 1 + 
     1           IOFFVV(IRPC,IRPAC,5) * VRT(IRPB,1)
C
      CALL EXPW(T3(IOFFT3+1),W(IOFFBC+1),W(IOFFAC+1),
     1          IRPDPD(IRPAB,1),VRT(IRPC,2),VRT(IRPA,1),VRT(IRPB,1))
C
 1120 CONTINUE
C
      ELSE
C
C     IRPAB = 1 (IE IRPA = IRPB)
C
      DO 1130 IRPB=1,NIRREP
      IRPA = IRPB
C
      IRPBC = DIRPRD(IRPB,IRPC)
      IRPAC = DIRPRD(IRPA,IRPC)
C
      IBLKAB = IOFFVV(IRPB,IRPAB,1)
      IOFFT3 = IADBLK(IRPC)  - 1 + IBLKAB
      IOFFBC =   IADW(IRPBC) - 1 + 
     1           IOFFVV(IRPC,IRPBC,5) * VRT(IRPA,1)
      IOFFAC =   IADW(IRPAC) - 1 + 
     1           IOFFVV(IRPC,IRPAC,5) * VRT(IRPB,1)
C
      CALL EXPW2(T3(IOFFT3+1),W(IOFFBC+1),IRPDPD(IRPAB,1),
     1           VRT(IRPC,2),VRT(IRPA,1),VRT(IRPB,1))
C
 1130 CONTINUE
C
      ENDIF
C
 1150 CONTINUE
      RETURN
      END
