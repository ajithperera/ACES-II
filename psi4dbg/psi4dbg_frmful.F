      SUBROUTINE PSI4DBG_FRMFUL(DOO,DVV,DVO,DFULL,ISCR,MAXCOR,NBAS,
     &                          IUHF,NON_HF)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER POP,VRT
      LOGICAL NON_HF

      DIMENSION DOO(1),DVV(1),DVO(1),DFULL(NBAS,NBAS),ISCR(MAXCOR)
      COMMON /INFO/ NOCCO(2),NVRTO(2)
      COMMON /FLAGS/ IFLAGS(100)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYM2/ POP(8,2),VRT(8,2),NDOVA,NDOVB,NDOOA,NDOOB,NDVVA,
     &              NDVVB
#include "sympop.com"
      DATA IONE /1/
C
      IOFFO =1
      IOFFV =1
      IOFFOV=1
      
      DO 100 ISPIN=1,1+IUHF
       CALL DZERO(DFULL,NBAS*NBAS)
C
C FIRST, PUT THE OO, VV AND VO BLOCKS INTO PLACE.
C
       LENOO=NOCCO(ISPIN)*NOCCO(ISPIN)
       LENVV=NVRTO(ISPIN)*NVRTO(ISPIN)
       LENVO=NVRTO(ISPIN)*NOCCO(ISPIN)

       I000=1
       I010=I000+LENOO*IINTFP
       I020=I010+LENOO
       IF(I020.GT.MAXCOR)CALL INSMEM('FILFUL',I020,MAXCOR)
       CALL PUTBLK(DFULL,DOO(IOFFO),'OO',ISCR(I000),ISCR(I010),
     &             NBAS,IRPDPD(1,20+ISPIN),LENOO,ISPIN)

       I000=1
       I010=I000+LENVV*IINTFP
       I020=I010+LENVV
       IF(I020.GT.MAXCOR)CALL INSMEM('FILFUL',I020,MAXCOR)
       CALL PUTBLK(DFULL,DVV(IOFFV),'VV',ISCR(I000),ISCR(I010),
     &             NBAS,IRPDPD(1,18+ISPIN),LENVV,ISPIN)

       IF (NON_HF) THEN
          I000=1
          I010=I000+LENVO*IINTFP
          I020=I010+LENVO
          IF(I020.GT.MAXCOR)CALL INSMEM('FILFUL',I020,MAXCOR)
          CALL PUTBLK(DFULL,DVO(IOFFOV),'VO',ISCR(I000),ISCR(I010),
     &                NBAS,IRPDPD(1,8+ISPIN),LENVO,ISPIN)
          DO IROW = 1, NOCCO(ISPIN) 
             DO ICOL = 1, NOCCO(ISPIN)+NBAS
                DFULL(IROW,ICOL) = DFULL(ICOL,IROW)
             ENDDO
          ENDDO
       ENDIF 
       IOFFO=IOFFO+NDOOA
       IOFFV=IOFFV+NDVVA
       IOFFOV=IOFFOV+NDOVA
100   CONTINUE

      RETURN
      END 
