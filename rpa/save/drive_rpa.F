      SUBROUTINE DRIVE_RPA(ICORE,MAXCOR,IUHF)
C
      IMPLICIT INTEGER (A-Z)
      DIMENSION ICORE(MAXCOR)
C
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),ID(18)
#
#include "machsp.com"
C
      IF (IUHF.EQ.0)THEN
C
          NSIZ=IRPDPD(1,ISYTYP(1,25))
C
          I000=1
          I010=I000+2*IINTFP*NSIZ
          MXCOR=MAXCOR-I010+1
          CALL DO_RHF_RPA(ICORE(I010),MXCOR,ICORE(I000),NSIZ,IUHF)
C
      ELSEIF (IUHF.EQ.1) THEN

          NSIZ=IRPDPD(1,ISYTYP(1,19))+IRPDPD(1,ISYTYP(1,20))

          I000=1
          I010=I000+2*IINTFP*NSIZ
          MXCOR=MAXCOR-I010+1
          CALL DO_UHF_RPA(ICORE(I010),MXCOR,ICORE(I000),NSIZ,IUHF)

      ENDIF
C
      RETURN
      END
