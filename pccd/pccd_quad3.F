       sUBROUTINE PCCD_QUAD3(ICORE,MAXCOR,IUHF,FACT)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER DIRPRD,DISSYW,DISSYT,POP,VRT
      DIMENSION ICORE(MAXCOR)
      COMMON /SYM/ POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF1BB,NF2AA,NF2BB
      COMMON /INFO/ NOCCO(2),NVRTO(2)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /FILES/ LUOUT,MOINTS
CSSS      COMMON /SWITCH/ MBPT3,MBPT4,CC,TRPEND,SNGEND,GRAD,MBPTT,SING1,
CSSS     &                QCISD,UCC
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     &DIRPRD(8,8)
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),NTOT(18)

      DO 1000 ISPIN=1,IUHF+1
C
       IF(ISPIN.EQ.1) THEN
        NVRTSQ=NF2AA
       ELSE
        NVRTSQ=NF2BB
       ENDIF
C
       I000   = MAXCOR + 1 - NVRTSQ*IINTFP
       MAXCOR = MAXCOR - NVRTSQ*IINTFP
       CALL ZERO(ICORE(I000),NVRTSQ)

       LISTT=46
       LISTW=16

       DO 200 IRREP=1,NIRREP
          DISSYW=IRPDPD(IRREP,ISYTYP(1,LISTW))
          DISSYT=IRPDPD(IRREP,ISYTYP(1,LISTT))
          NUMSYW=IRPDPD(IRREP,ISYTYP(2,LISTW))
          NUMSYT=IRPDPD(IRREP,ISYTYP(2,LISTT))
          I001=1
          I002=I001+IINTFP*NUMSYW*DISSYW
          I003=I002+IINTFP*NUMSYT*DISSYT
          I004=I003+IINTFP*NUMSYT*DISSYT
           IF(MIN(NUMSYT,NUMSYW,DISSYT,DISSYW).NE.0) THEN
            I005=I004+3*IINTFP*MAX(DISSYT,DISSYW,NUMSYW,NUMSYT)
            IF(I005.LE.MAXCOR) THEN

             CALL PCCD_Q3AB(ICORE(I001),ICORE(I002),ICORE(I003),
     &                      ICORE(I000),ICORE(I004),
     &                      POP(1,ISPIN),POP(1,3-ISPIN),VRT(1,ISPIN),
     &                      VRT(1,3-ISPIN),NVRTSQ,DISSYW,DISSYT,
     &                      NUMSYW,NUMSYT,IRREP,FACT,IUHF,ISPIN)
         ELSE
             CALL INSMEM('PDCC_QUAD3',I005,MAXCOR)
         ENDIF
        ELSE
        ENDIF
200   CONTINUE
      CALL PUTLST(ICORE(I000),1,1,1,ISPIN,92)
1000  CONTINUE

      RETURN
      END 
