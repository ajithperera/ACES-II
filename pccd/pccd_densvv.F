      SUBROUTINE PCCD_DENSVV(DVV,ICORE,MAXCOR,IUHF)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER DIRPRD,DISSYT,POP,VRT
      DIMENSION ICORE(MAXCOR),DVV(1)
C
      COMMON/SYM/POP(8,2),VRT(8,2),NTAA,NTBB,NF1(2),NF2(2)
      COMMON/INFO/NOCCO(2),NVRTO(2)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/FLAGS/IFLAGS(100)
      COMMON/SYMINF/NSTART,NIRREP,IRREPA(255),IRREPB(255),DIRPRD(8,8)
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),NTOT(18)
C
      DATA ONE,TWO,ONEM,HALF /1.0D0,2.0D0,-1.0D0,0.5D0/
C
      MXCOR=MAXCOR
      LISTT1=46
      LISTT2=146
      FACT=ONE
      IOFF=1
      IFLAG=2 

      DO 200 IRREP=1,NIRREP
C
        DISSYT=IRPDPD(IRREP,ISYTYP(1,46))
        NUMSYT=IRPDPD(IRREP,ISYTYP(2,46))
        I001=1
        I002=I001+IINTFP*NUMSYT*DISSYT
        I003=I002+IINTFP*NUMSYT*DISSYT
        I004=I003+IINTFP*NUMSYT*DISSYT

        IF(MIN(NUMSYT,DISSYT).NE.0) THEN
         I005=I004+3*IINTFP*MAX(DISSYT,NUMSYT)
         IF(I005.LE.MXCOR) THEN
C
          CALL DVVAB(ICORE(I001),ICORE(I002),ICORE(I003),DVV(IOFF),
     &               FACT,1,POP(1,1),POP(1,2),VRT(1,1),VRT(1,2), 
     &               DISSYT,NUMSYT,LISTT1,LISTT2,LISTT3,IRREP,
     &               ICORE(I004),IUHF,IFLAG)  
         ELSE
          CALL INSMEM('PCCD_DVVAB',I005,MXCOR)
         ENDIF
        ELSE
        ENDIF
200    CONTINUE

       CALL SYMMET5(DVV(IOFF),ICORE,VRT(1,1))
       NVRTSQ = NVRTO(1)*NVRTO(1)
       CALL PUTREC(20,"JOBARC","DENSVV  ",NVRTSQ*IINTFP,DVV(IOFF))
      RETURN
      END
