      SUBROUTINE PCCD_LADAB1(W,T,Z,MAXSIZE,DISSYW,NUMSYW,DISSYT,NUMSYT,
     &                       LISTW,LISTT,POP1,POP2,VRT1,VRT2,ITYPE,
     &                       IRREP,IUHF)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER DISSYT,DISSYW,DIRPRD,POP1,POP2,VRT1,VRT2
      INTEGER DISREAD,DISMAX,DISLEFT
      DIMENSION W(DISSYW),T(DISSYT,NUMSYT)
      DIMENSION Z(DISSYT,NUMSYT)
      DIMENSION POP1(8),POP2(8),VRT1(8),VRT2(8),T1A(1),T1B(1)
      COMMON /MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /SYMINF/ NSTART,NIRREP,IRREPA(255),IRREPB(255),
     &DIRPRD(8,8)
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),NTOT(18)
      DATA ONE,AZERO /1.0D0,0.D0/

      CALL GETLST(T,1,NUMSYT,1,IRREP,LISTT)

      DISMAX=MAXSIZE/DISSYW
      IF(DISMAX.GE.NUMSYW) THEN
C
      CALL GETLST(W,1,NUMSYW,2,IRREP,LISTW)
      IF(ITYPE.EQ.6)THEN
       IF(IUHF.EQ.0.AND.ISYTYP(1,233).EQ.5) THEN
        CALL XGEMM('N','N',DISSYW,NUMSYT,DISSYT,ONE,W,DISSYW,
     &             T,DISSYT,AZERO,Z,DISSYW)
        CALL SYMEXP4(IRREP,VRT1,POP1,DISSYT,DISSYW,NUMSYT,Z,Z,W)
       ELSE
        CALL XGEMM('N','N',DISSYW,NUMSYT,DISSYT,ONE,W,DISSYW,
     &             T,DISSYT,AZERO,Z,DISSYW)
       ENDIF
      ELSE
        CALL XGEMM('N','N',DISSYT,DISSYW,DISSYW,ONE,T,DISSYT,
     &             W,DISSYW,AZERO,Z,DISSYT)
      ENDIF
C
      ELSE

       CALL ZERO(Z,NUMSYT*DISSYT)
C
       IOFFSET=1
       DISLEFT=NUMSYW
10     CONTINUE
       DISREAD=MIN(DISMAX,DISLEFT)
       DISLEFT=DISLEFT-DISREAD
       CALL GETLST(W,IOFFSET,DISREAD,2,IRREP,LISTW)

       IF(ITYPE.EQ.6) THEN
        CALL XGEMM('N','N',DISSYW,NUMSYT,DISREAD,ONE,W,DISSYW,
     &             T(IOFFSET,1),DISSYT,ONE,Z,DISSYW)
       ELSE
        CALL XGEMM('N','N',DISSYT,DISREAD,DISSYW,ONE,T,DISSYT,
     &             W,DISSYW,ONE,Z(1,IOFFSET),DISSYT)
       ENDIF

       IOFFSET=IOFFSET+DISREAD
       IF(DISLEFT.NE.0) GO TO 10
       IF(IUHF.EQ.0.AND.ISYTYP(1,233).EQ.5)THEN
        CALL SYMEXP4(IRREP,VRT1,POP1,DISSYT,DISSYW,NUMSYT,Z,Z,T)
        CALL GETLST(T,1,NUMSYT,1,IRREP,LISTT)
       ENDIF  
      ENDIF
      CALL SUMSYM2(Z,T,NUMSYT*DISSYT,1,IRREP,63)

      RETURN
      END
