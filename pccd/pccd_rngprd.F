      SUBROUTINE PCCD_RNGPRD(W,T,Q,SCR,MAXCOR,DISSYW,NUMSYW,DISSYT,
     &                       NUMSYT,DISSYQ,NUMSYQ,LISTW,LISTT,IRREP,
     &                       CALMOD,SPINAD)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      INTEGER POP,VRT
      LOGICAL SPINAD
      LOGICAL MBPT3,MBPT4,CC,TRPEND,SNGEND,GRAD,MBPTT,
     &              SING1,QCISD,UCC,CC2
      CHARACTER*3 CALMOD
      INTEGER DISSYT,DISSYW,DISSYQ
      DIMENSION W(DISSYW,NUMSYW),T(DISSYT,NUMSYT),Q(DISSYQ,NUMSYQ)
      DIMENSION SCR(MAXCOR)
      COMMON /SYM/ POP(8,2),VRT(8,2),NT(6)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
CSSS      COMMON/SWITCH/MBPT3,MBPT4,CC,TRPEND,SNGEND,GRAD,MBPTT,
CSSS     &              SING1,QCISD,UCC,CC2
      COMMON /FLAGS2/ IFLAGS2(500)
      DATA ONE /1.0/
      DATA TWO /2.0/
      DATA ONEM/-1.0/
      DATA HALFM/-0.5/
      DATA ZILCH/0.0/

      CALL GETLST(T,1,NUMSYT,1,IRREP,LISTT)
      CALL DSCAL(NUMSYT*DISSYT,2.0D0,T,1)

C Here listt is 37 T2(Ij,Ab) AI,bj(11,22). List 39 is T(Ij||Ab)
C Aj,bI(12,21)

      IF(SPINAD)THEN
          CALL GETLST(W,1,NUMSYT,1,IRREP,39)
          CALL SAXPY(NUMSYT*DISSYT,ONEM,W,1,T,1)
          LISTW=56
      ENDIF
C
      CALL GETLST(W,1,NUMSYW,2,IRREP,LISTW)

C      Write(6,*) "Wmbej"
C      Write(6,"(6(1x,F15.10))") ((W(i,j),i=1,DISSYW),j=1,NUMSYW)
C      Write(6,*) "T2"
C      Write(6,"(6(1x,F15.10))") ((T(i,j),i=1,DISSYT),j=1,NUMSYT)

      IF(MIN(DISSYT,NUMSYT,NUMSYW).NE.0)THEN
       CALL XGEMM('N','N',DISSYT,NUMSYW,NUMSYT,ONE,T,DISSYT,
     &            W,DISSYW,ZILCH,Q,DISSYT)
c       CALL MXM(T,DISSYT,W,NUMSYT,Q,NUMSYW)
C      Write(6,*) "T2*Q"
C      Write(6,"(6(1x,F15.10))") ((Q(i,j),i=1,DISSYQ),j=1,NUMSYQ)
      ELSE
       CALL ZERO(Q,NUMSYQ*DISSYQ)
      ENDIF
      IF(SPINAD)CALL SSCAL(NUMSYQ*DISSYQ,HALFM,Q,1)
      RETURN
      END
