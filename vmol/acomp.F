      SUBROUTINE ACOMP(SAAB,NUCA)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
#include "baslims.par"
      parameter (nh4=4*nht-3, nh2=nht+nht+1)
      parameter (mxp2=maxprim*maxprim)
      COMMON/NULL_COM/  FACT(nh4),RFACT(nh4),FACTM(nh4),RFACTM(nh4)
     & ,MAA,IFD1,IFD2,KCD,KBCD,NHCD,NHBCD,NNC,IFPL(3),
     & NN1,NN2,NHKTA,NHKTB,NHKTC,NHKTD,KHKTA,KHKTB,KHKTC,KHKTD,NNB
      DIMENSION SAAB(NUCA,NUCA),AINT(NUC1,NUC1,NUC34),
     $ BINT(NUC34,NUC1,NUC1),AAINT(NUC1,NUC1,NUC34,2),
     $ BBINT(NUC34,NUC1,NUC1,2)
C...  TRIANGULARIZE THE RADIAL OVERLAP VECTOR IF IT IS SYMMETRIC !
C
      DO 20 I=2,NUCA
      DO 10 J=1,I-1
      SAAB(J,I) = SAAB(J,I)*2.
      SAAB(I,J) = 0.
   10 CONTINUE
   20 CONTINUE
      RETURN
      ENTRY BCOMP(SAAB,NUCA)
      DO 21 I=2,NUCA
      DO 11 J=1,I-1
      SAAB(J,I) = SAAB(J,I)*0.5
      SAAB(I,J) = SAAB(J,I)
   11 CONTINUE
   21 CONTINUE
      RETURN
      ENTRY AEXP(AINT,NUC1,NUC34)
C...  EXPAND THE PRIMITIVE INTEGRAL SET IF THE RADIAL OVERLAP
C     VECTOR HAD PREVIOUSLY BEEN TRIANGULARIZED.
C     THIS IS NECESSARY ONLY IN CASE OF GENERAL CONTRACTION !
C
C...  TRIANGULARITY IN P AND Q (INNER PAIR-LOOP)
      DO 50 IP=2,NUC1
      DO 40 IQ=1,IP-1
      DO 29 IRS=1,NUC34
   29 AINT(IQ,IP,IRS) = 0.5*(AINT(IQ,IP,IRS)+AINT(IP,IQ,IRS))
CDIR$ IVDEP
*VOCL LOOP,NOVREC
      DO 30 IRS=1,NUC34
   30 AINT(IP,IQ,IRS) = AINT(IQ,IP,IRS)
   40 CONTINUE
   50 CONTINUE
      RETURN
      ENTRY BEXP (BINT,NUC1,NUC34)
C     TRIANGULAR IN IR AND IS (OUTER PAIR-LOOP)
      DO 90 IR=2,NUC1
      DO 80 IS=1,IR-1
      DO 69 IPQ=1,NUC34
   69 BINT(IPQ,IR,IS) = 0.5*(BINT(IPQ,IS,IR)+BINT(IPQ,IR,IS))
CDIR$ IVDEP
*VOCL LOOP,NOVREC
      DO 70 IPQ=1,NUC34
   70 BINT(IPQ,IS,IR) = BINT(IPQ,IR,IS)
   80 CONTINUE
   90 CONTINUE
      RETURN
      ENTRY AAEXP (AAINT,NUC1,NUC34)
C...  TRIANGULARITY IN P AND Q (INNER PAIR-LOOP)
      DO 101 LOP=1,MAA
      DO 51 IP=2,NUC1
      DO 41 IQ=1,IP-1
      DO 26 IRS=1,NUC34
   26 AAINT(IQ,IP,IRS,LOP) = 0.5*(AAINT(IQ,IP,IRS,LOP)
     $ + AAINT(IP,IQ,IRS,LOP))
CDIR$ IVDEP
*VOCL LOOP,NOVREC
      DO 31 IRS=1,NUC34
   31 AAINT(IP,IQ,IRS,LOP) = AAINT(IQ,IP,IRS,LOP)
   41 CONTINUE
   51 CONTINUE
  101 CONTINUE
      RETURN
      ENTRY BBEXP (BBINT,NUC1,NUC34)
C     TRIANGULAR INIR AND IS (OUTER PAIR-LOOP)
      DO 111 LOP=1,MAA
      DO 91 IR=2,NUC1
      DO 81 IS=1,IR-1
      DO 65 IPQ=1,NUC34
   65 BBINT(IPQ,IR,IS,LOP) = 0.5*(BBINT(IPQ,IS,IR,LOP)
     $ + BBINT(IPQ,IR,IS,LOP))
CDIR$ IVDEP
*VOCL LOOP,NOVREC
      DO 71 IPQ=1,NUC34
   71 BBINT(IPQ,IS,IR,LOP) = BBINT(IPQ,IR,IS,LOP)
   81 CONTINUE
   91 CONTINUE
  111 CONTINUE
      RETURN
      END
