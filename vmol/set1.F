      SUBROUTINE SET1(NRSS,I2,A2,I1,A1)
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
#include "baslims.par"
      parameter (nh4=4*nht-3)
      DIMENSION I2(*),A2(*),I1(50),A1(*)
      COMMON /TAB/ NNNGAM
      COMMON/NULL_COM/FACT(nh4),RFACT(nh4),FACTM(nh4),RFACTM(nh4)
     & ,MAA,IFD1,IFD2,KCD,KBCD,NHCD,NHBCD,NNC,IFPL(3),
     & NN1,NN2,NHKTA,NHKTB,NHKTC,NHKTD,KHKTA,KHKTB,KHKTC,KHKTD,NNB
      COMMON /REP/ NEWIND(MXCBF) , MSTOLD(8)
      COMMON /CONI/ NUCR,NUCS,NUCA,NUCQ,
     & NRCR,NRCS,NRCA,NRCQ,JSTR,JSTS,JSTA,JSTQ,
     & IFD1X,IFD2X,NUCAQ,NUCRS,NAQRS,NCQRS,KQ,KR,KS,IVA
      NSB=NNNGAM + 3*(NNB+NNNGAM-1)
      NSB=MAX0(NSB,8)
      NRSR = (I1(50)-I1(7))/(NSB*NUCAQ)
      IF(NRSR .LE. 0) GO TO 666
      NPASS = 1 + NUCRS/(NRSR+1)
C      FOR TESTING PURPOSES
C      NPASS=MIN0(NUCRS,NUCRS)
C
  667 NRSS=(NUCRS-1)/NPASS + 1
      KQ = 1
      KR = 1
      KS = 1
      IVA= 1
      RETURN
      ENTRY SET2(NRSS,ITAG,I2,A2,I1,A1)
      NSB=NNNGAM + 3*(NNB+NNNGAM-1)
      NSB=MAX0(NSB,8)
      NRSR = (I1(50)-I1(7))/(NSB*NUCAQ)
      IF(NRSR .LE. 0) GO TO 666
      NPASS = 1 + NUCRS/(NRSR+1)
C
      ITAG=1
      IF(NPASS .GT.NUCR) THEN
      ITAG=3
      NPASS = NUCRS
      ELSE IF(NPASS .GT. 1) THEN
      ITAG=2
      NPASS = NUCR
      ENDIF
      GO TO 667
  666 WRITE (6,*) ' COMMON/W1/ IS TOO SMALL. INCREASE, AND TRY AGAIN'
      WRITE (6,*) ' NRSR,I1(7),I1(50), NSB,NUCAQ'
      WRITE (6,6666) NRSR,I1(7),I1(50),NSB,NUCAQ
 6666 FORMAT (5I10)
      CALL ERREX
      END
