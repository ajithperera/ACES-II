 
      SUBROUTINE MPINFO2(NDISSTRT,NAODIS,IKEEP,IRR0,IDIS0,
     &                   IDISSTRT,IRRSTRT,IMAP,NAO,IRRBEGIN,
     &                   IRREND,NSIZE0,NWORDS)
C
C CALCULATES INFORMATION ABOUT DISTRIBUTIONS WHICH ARE TO BE
C PROCESSED ON A PARTICULAR CYCLE THROUGH THE MULTIPASS ALGORITHM
C
      IMPLICIT INTEGER (A-Z)
      DIMENSION NAODIS(8),NDISSTRT(8),IKEEP(*),IMAP(*)
      COMMON/MACHSP/IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON/SYMINF/NSTART,NIRREP,IRREPS(255,2),DIRPRD(8,8)
      COMMON/AOSYM/IAOPOP(8),IOFFAO(8),IOFFV(8,2),IOFFO(8,2),
     &             IRPDPDAO(8),IRPDPDAOS(8),ISTART(8,8),ISTARTMO(8,3)
      COMMON/SYMPOP/IRPDPD(8,22),ISYTYP(2,500),ID(18)
      COMMON/SYM/POP(8,2),VRT(8,2),NT(2),NFMI(2),NFEA(2)
      COMMON/INFO/NOCCO(2),NVRTO(2)
C
      CALL IZERO(NAODIS,8)
      CALL IZERO(IKEEP,NAO*NAO)
      IDISSTRT=IDIS0
      IRRSTRT =IRR0
      IRRBEGIN=IRR0
      NSIZE=NSIZE0/IINTFP
      NWORDS=0
C
C OK. WE KNOW THE IRREP AND THE INDEX OF THE FIRST DISTRIBUTION
C WHICH WILL BE PROCESSED ON THIS PASS.  LET US THEN CALCULATE THE
C LAST IRREP AND DISTRIBUTION WHICH WILL BE CALCULATED BASED ON THE
C NUMBER OF WORDS OF AVAILABLE CORE.
C
1     IF(IRRSTRT.GT.NIRREP)GOTO 100
      NDISSTRT(IRRSTRT)=IDISSTRT
C
C SEE IF THE REST OF THE DISTRIBUTIONS IN THIS IRREP CAN BE HELD
C IN CORE
C
      NDISIRR=IRPDPDAO(IRRSTRT)
      NDISLFT=NDISIRR-IDISSTRT+1
      NSIZLFT=NDISLFT*IRPDPDAO(IRRSTRT)
      IF(NSIZLFT.LE.NSIZE)THEN
       NAODIS(IRRSTRT)=NDISLFT
       NWORDS=NWORDS+NDISLFT*IRPDPDAO(IRRSTRT)
       IRRSTRT=IRRSTRT+1
       IDISSTRT=1
       NSIZE=NSIZE-NSIZLFT
       GOTO 1 
      ELSE
       NAODIS(IRRSTRT)=NSIZE/IRPDPDAO(IRRSTRT)
       NWORDS=NWORDS+NAODIS(IRRSTRT)*IRPDPDAO(IRRSTRT)
       IDISSTRT=IDISSTRT+NAODIS(IRRSTRT)
       IF(IDISSTRT.GT.NDISIRR)THEN
        IRRSTRT =IRR0+1
        IDISSTRT=1
       ELSE
       ENDIF
      ENDIF
C
100   CONTINUE
      IRREND=MIN(NIRREP,IRRSTRT)
C
      IOFF=0
      DO 10 IRREP=1,NIRREP
       IBEGIN=NDISSTRT(IRREP)+IOFF
       IEND=IBEGIN+NAODIS(IRREP)-1
       DO 11 I=IBEGIN,IEND
        IKEEP(IMAP(I))=1
11     CONTINUE
       IOFF=IOFF+IRPDPDAO(IRREP)
10    CONTINUE
C
c      write(6,*)' irrep     starting dist    final dist   irpdpao '
c      do 22 i=1,nirrep
c       write(6,'(4I10)')i,ndisstrt(i),ndisstrt(i)+naodis(i)-1,
c     &                  irpdpdao(i)
c22    continue
      RETURN
      END 
