C
C DRIVER FOR AO-BASED PARTICLE-PARTICLE LADDER CONTRACTION
C
      SUBROUTINE DRAOLAD(ICORE,MAXCOR,IUHF,LAMBDA,IRREPX,LISTFLAG,
     &                   LSTMO,LSTMOINC,LSTAO,LSTAOINC)
      IMPLICIT INTEGER (A-Z)
      LOGICAL TAU,MBPT3,MBPT4,CC,TRPEND,SNGEND,GRAD,MBPTT,SING1,
     &        QCISD,ROHF4,ITRFLG,LAMBDA
      LOGICAL SING
      COMMON /SYMINF/NSTART,NIRREP,IRREPY(255,2),DIRPRD(8,8)
      COMMON /INFO/ NOCCO(2),NVRTO(2)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /FILES/ LUOUT,MOINTS
      COMMON /SWITCH/ MBPT3,MBPT4,CC,TRPEND,SNGEND,GRAD,MBPTT,SING1,
     &                QCISD,UCC
      COMMON /SYM/POP(8,2),VRT(8,2),NTAA,NTBB,NF1AA,NF1BB,NF2AA,NF2BB
      COMMON /SYMPOP/ IRPDPD(8,22),ISYTYP(2,500),NJUNK(18)
      COMMON /CONTROL/ IPRNT,IXXX,IXXX2
      COMMON /FLAGS/ IFLAGS(100)
      COMMON /ROHF/ ROHF4,ITRFLG
C
      EQUIVALENCE(IFLAGS(2),METHOD)
C
      TAU=METHOD.GT.9.AND.SING1.AND.(.NOT.QCISD).OR.
     &   (ROHF4.AND..NOT.ITRFLG)
      SING=(METHOD.NE.2.AND.METHOD.NE.5.AND.METHOD.NE.8.AND.
     &        METHOD.NE.20.AND.METHOD.NE.24.AND.(.NOT.LAMBDA))
C
      CALL AOLADLST(IUHF,LISTFLAG,IRREPX)
      CALL T2TOAO(ICORE,MAXCOR,IUHF,TAU,LSTMO,LSTAO,IRREPX)
      IF(IFLAGS(95).EQ.1)THEN
       CALL AOLAD2(ICORE,MAXCOR,IUHF,TAU,IRREPX,LSTAO,LSTAOINC)
      ELSE
       CALL AOLAD3(ICORE,MAXCOR,IUHF,TAU,IRREPX,LSTAO,LSTAOINC)
      ENDIF
      CALL Z2TOMO(ICORE,MAXCOR,IUHF,TAU,IRREPX,LSTMO,LSTMOINC,
     &            LSTAOINC,.FALSE.)
      IF (SING) CALL ZIAAO(ICORE,MAXCOR,IUHF,IRREPX,90)
C
      RETURN
      END
