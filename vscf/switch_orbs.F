
      SUBROUTINE SWITCH_ORBS(IRRP,IBGN,IEND,NBAS,EVAL,EVEC,LDIM2,
     &                       ISPN,IOS)

      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION EVAL(1),EVEC(1),SCR(1),ZJUNK
      DIMENSION ILOCATE(1)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /POPUL/ NOCC(8,2)

#include "symm2.com"
C
      INDX2(I,J,N)=I+(J-1)*N
C
#ifdef _DEBUG_LVL0
      Write(6,"(a,4I6)") "ISPN,IBGN,IEND,IOS:",ISPN,IBGN,IEND,IOS
#endif 
      DO ISPIN=1,2

         IF(IOS.EQ.0.AND.ISPIN.EQ.ISPN) THEN

         IPOS1=(ISPIN-1)*LDIM2+ISQROF(IRRP)-1+INDX2(1,IBGN,NBFIRR(IRRP))
         IPOS2=(ISPIN-1)*LDIM2+ISQROF(IRRP)-1+INDX2(1,IEND,NBFIRR(IRRP))

#ifdef _DEBUG_LVL0
      Write(6,"(a,2I6)") "IPOS1 and IPOS2   :", IPOS1,IPOS2
#endif 
         CALL DSWAP(NBFIRR(IRRP),EVEC(IPOS1),1,EVEC(IPOS2),1)
C
         IOFF1=IRPOFF(IRRP)+IBGN
         IOFF2=IRPOFF(IRRP)+IEND
         ZJUNK=EVAL((ISPIN-1)*NBAS+IOFF1)
         EVAL((ISPIN-1)*NBAS+IOFF1)=EVAL((ISPIN-1)*NBAS+IOFF2)
         EVAL((ISPIN-1)*NBAS+IOFF2)=ZJUNK

         ENDIF 
C
      ENDDO

      RETURN
      END
