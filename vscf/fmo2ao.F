      SUBROUTINE FMO2AO(FOCK,EVEC,SCR2,SCR3,POP,VRT,NIRREP)
C
C TRANSFORMS THE FOCK MATRIX TO THE MOLECULAR ORBITAL BASIS
C
CEND
      IMPLICIT INTEGER (A-Z)
      DOUBLE PRECISION FOCK,EVEC,ONE,ZILCH,SCR2,SCR3
      DIMENSION FOCK(1),EVEC(1),SCR2(1),SCR3(1)
      DIMENSION POP(NIRREP),VRT(NIRREP)
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      DATA ONE /1.0/
      DATA ZILCH /0.0/
      IOFF1=1
      IOFF2=1
      DO 10 IRREP=1,NIRREP
       NOCC=POP(IRREP)
       NVRT=VRT(IRREP)
       NSIZ=NOCC+NVRT
       CALL EXPND2(FOCK(IOFF1),SCR2,NSIZ)
       CALL XGEMM('N','T',NSIZ,NSIZ,NSIZ,ONE,SCR2,NSIZ,
     &            EVEC(IOFF2),NSIZ,ZILCH,SCR3,NSIZ)
       CALL XGEMM('N','N',NSIZ,NSIZ,NSIZ,ONE,EVEC(IOFF2),
     &            NSIZ,SCR3,NSIZ,ZILCH,SCR2,NSIZ)
       CALL SQUEZ2(SCR2,FOCK(IOFF1),NSIZ)
       IOFF1=IOFF1+(NSIZ*(NSIZ+1))/2
       IOFF2=IOFF2+NSIZ*NSIZ
10    CONTINUE
      RETURN
      END
