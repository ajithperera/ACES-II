      SUBROUTINE PKCHAN3(ICHAIN,PK,IDISSIZ,IDISNUM,BUF,IBUF,SCR,IBKSTRT,
     &                   IBKOF,MAXBUK,IBKDIS,IBKSIZ,NBUCK,NBKINT,MAXDIS,
     &                   IUHF)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      PARAMETER(LUSRT3=23)
C
      DIMENSION ICHAIN(3*NBUCK),IDISNUM(IBKDIS,2)
      DIMENSION PK(IBKSIZ),IDISSIZ(IBKDIS)
      DIMENSION IBKSTRT(MAXBUK),IBKOF(MAXBUK)
      DIMENSION BUF(NBKINT),IBUF(NBKINT)
      DIMENSION SCR(MAXDIS)
C
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /FILES/ LUOUT,MOINTS
#include "symm2.com"
      COMMON /TIMEINFO/ TIMEIN, TIMENOW, TIMETOT, TIMENEW
C
      DATA ONE /1.0/
C
      INDX(I,J)=J+(I*(I-1))/2
C
      CALL TIMER(1)
C
      DO 50 IBK=1,NBUCK
        CALL ZERO(PK,IBKSIZ)
        IF(ICHAIN(2*NBUCK+IBK).EQ.0) GOTO 310
  299   READ(LUSRT3,REC=ICHAIN(2*NBUCK+IBK))BUF,IBUF,NUT,ICHAN
        ICHAIN(2*NBUCK+IBK)=ICHAN
        DO 300 INT=1,NUT
          IADR=IBUF(INT)-IBKOF(IBK)
          PK(IADR)=PK(IADR)+BUF(INT)
  300   CONTINUE
        IF(ICHAIN(2*NBUCK+IBK).NE.0) GOTO 299
C
  310   CONTINUE
C
        ISTART=IBKSTRT(IBK)
        IEND=IBKSTRT(IBK+1)-1
        IOFF=1
        DO 400 I=ISTART,IEND
          CALL GETLST(SCR,IDISNUM(I,1),1,2,1,IDISNUM(I,2))
          CALL SAXPY(IDISSIZ(I),ONE,PK(IOFF),1,SCR,1)
          CALL PUTLST(SCR,IDISNUM(I,1),1,2,1,IDISNUM(I,2))
          IOFF=IOFF+IDISSIZ(I)
  400   CONTINUE
C
   50 CONTINUE
C
      CLOSE(UNIT=LUSRT3,STATUS='DELETE')
C
      CALL TIMER(1)
      WRITE(LUOUT,5000)TIMENEW
 5000 FORMAT(T3,'@PKCHAN3-I, Chaining of PK lists required ',F10.3,
     &          ' seconds.',/)
C
      RETURN
      END
