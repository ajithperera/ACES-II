

      SUBROUTINE MAKMAP(NSTO,NIRREP,NBFIRR,IMAP)
C
C THIS ROUTINE CONSTRUCTS A VECTOR WHICH RELATES A TRIANGULARLY
C  PACKED C1 INDEX WITH A SYMMETRY BLOCKED TRIANGULAR INDEX.  
C  THIS IS USED IN READING DIPOLE INTEGRALS
C
      IMPLICIT INTEGER (A-Z)
      DIMENSION IMAP(1),NBFIRR(NIRREP) 
      INDXT(I,J)=I+(J*(J-1))/2
C
C FIRST ZERO OUT IMAP VECTOR
C
      LENGTH=(NSTO*(NSTO+1))/2
      DO 5 IBAS=1,LENGTH
       IMAP(IBAS)=0
5     CONTINUE 
C
      IBOT=1
      IPOSP=0
      DO 10 IRREP=1,NIRREP
       NBASIR=NBFIRR(IRREP)
       DO 20 INDX1=IBOT,IBOT+NBASIR-1
        DO 21 INDX2=IBOT,INDX1
         IPOSP=IPOSP+1
         IPOSF=INDXT(INDX2,INDX1)
         IMAP(IPOSF)=IPOSP 
21      CONTINUE
20     CONTINUE
       IBOT=IBOT+NBASIR
10    CONTINUE
C
      RETURN
      END
