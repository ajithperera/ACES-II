      SUBROUTINE MKFULL(WFULL,WCHUNK,SCR,LDIM1,LDIM2,NBAS,JFLAG)
C
      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
C
      DIMENSION WFULL(NBAS,NBAS),WCHUNK(LDIM1)
      DIMENSION SCR(LDIM2)
C
#include "symm2.com"
C
      INDX2(I,J,N)=I+(J-1)*N
C
      IF(JFLAG.EQ.0) THEN
        DO 100 I=1,NIRREP
          DO 110 J=1,NBFIRR(I)
            DO 120 K=1,NBFIRR(I)
              WFULL(IRPOFF(I)+J,IRPOFF(I)+K)=WCHUNK(ISQROF(I)-1+
     &              INDX2(J,K,NBFIRR(I)))
  120       CONTINUE
  110     CONTINUE
  100   CONTINUE
      ELSEIF(JFLAG.EQ.1) THEN
        DO 101 I=1,NIRREP
          CALL EXPND2(WCHUNK(ITRIOF(I)),SCR,NBFIRR(I))
          DO 111 J=1,NBFIRR(I)
            DO 121 K=1,NBFIRR(I)
              WFULL(IRPOFF(I)+J,IRPOFF(I)+K)=SCR(INDX2(J,K,NBFIRR(I)))
  121       CONTINUE
  111     CONTINUE
  101   CONTINUE
      ENDIF
C
      RETURN
      END
