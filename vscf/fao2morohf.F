      SUBROUTINE FAO2MOROHF(FOCK,OVLP,EVEC,SCR2,SCR3,NBAS,BACK)
C
C TRANSFORMS THE FOCK MATRIX TO THE MOLECULAR ORBITAL BASIS
C
CEND
      IMPLICIT INTEGER (A-Z)
#include "symm2.com"
      DOUBLE PRECISION FOCK,EVEC,ONE,ZILCH,SCR2,SCR3,OVLP
      LOGICAL BACK
      DIMENSION FOCK(1),EVEC(1),SCR2(1),SCR3(1),OVLP(1)
      DATA ONE /1.0/
      DATA ZILCH /0.0/
      IOFF1=1
      IOFF2=1
      IOFF3=1
      DO 10 IRREP=1,NIRREP
       NSIZ=NBFIRR(IRREP)
       if (nsiz.ne.0) then
         CALL EXPND2(FOCK(IOFF1),SCR2,NSIZ)
         IF (BACK) THEN
           CALL XGEMM('N','T',NSIZ,NSIZ,NSIZ,ONE,SCR2,NSIZ,
     &                EVEC(IOFF2),NSIZ,ZILCH,SCR3,NSIZ)
           CALL XGEMM('N','N',NSIZ,NSIZ,NSIZ,ONE,EVEC(IOFF2),
     &                NSIZ,SCR3,NSIZ,ZILCH,SCR2,NSIZ)
           call xgemm('n','n',NSIZ,NSIZ,NSIZ,ONE,SCR2,NSIZ,
     &                OVLP(IOFF3),NBAS,ZILCH,SCR3,NSIZ)
           call xgemm('n','n',NSIZ,NSIZ,NSIZ,ONE,OVLP(IOFF3),
     &                NBAS,SCR3,NSIZ,ZILCH,SCR2,NSIZ)
         ELSE
           CALL XGEMM('N','N',NSIZ,NSIZ,NSIZ,ONE,SCR2,NSIZ,
     &                EVEC(IOFF2),NSIZ,ZILCH,SCR3,NSIZ)
           CALL XGEMM('T','N',NSIZ,NSIZ,NSIZ,ONE,EVEC(IOFF2),
     &                NSIZ,SCR3,NSIZ,ZILCH,SCR2,NSIZ)
         ENDIF
         CALL SQUEZ2(SCR2,FOCK(IOFF1),NSIZ)
         IOFF1=IOFF1+(NSIZ*(NSIZ+1))/2
         IOFF2=IOFF2+NSIZ*NSIZ
         IOFF3=IOFF3+NSIZ*(NBAS+1)
        endif
10    CONTINUE
      RETURN
      END
